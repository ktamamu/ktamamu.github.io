<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600" width="1000" height="600">
  <style>
    text { font-family: sans-serif; fill: #333; }
    .title { font-size: 20px; font-weight: bold; }
    .section-title { font-size: 16px; font-weight: bold; fill: #1976d2; }
    .box-title { font-size: 14px; font-weight: bold; fill: #01579b; }
    .text { font-size: 12px; }
    .small-text { font-size: 10px; fill: #666; }
    .mono { font-size: 10px; font-family: monospace; fill: #333; }
  </style>
  
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="600" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="500" y="30" class="title" text-anchor="middle">Lambda CI/CD Architecture (Lambroll + Terraform)</text>
  
  <!-- GitHub Organization Area -->
  <rect x="50" y="60" width="900" height="140" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="3"/>
  <text x="70" y="85" class="section-title">GitHub Organization</text>
  
  <!-- terraform-infrastructure repo -->
  <rect x="100" y="100" width="380" height="80" rx="5" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="290" y="120" class="box-title" text-anchor="middle">terraform-infrastructure</text>
  <text x="120" y="140" class="text">- VPC, IAM, RDS, S3, EventBridge</text>
  <text x="120" y="155" class="text">- Lambda Layer (ARN)</text>
  <text x="120" y="170" class="small-text">(Managed by: Infra Team)</text>
  
  <!-- lambda-applications repo -->
  <rect x="520" y="100" width="380" height="80" rx="5" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="710" y="120" class="box-title" text-anchor="middle">lambda-applications</text>
  <text x="540" y="140" class="text">- Lambda Functions (code + function.jsonl)</text>
  <text x="540" y="155" class="text">- Aliases</text>
  <text x="540" y="170" class="small-text">(Managed by: App Team)</text>
  
  <!-- AWS Account Area -->
  <rect x="50" y="230" width="900" height="330" rx="8" fill="#fff8e1" stroke="#ff9800" stroke-width="3"/>
  <text x="70" y="255" class="section-title">AWS Account</text>
  
  <!-- Terraform Outputs -->
  <rect x="100" y="280" width="240" height="110" rx="5" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="220" y="300" class="box-title" text-anchor="middle">Terraform Outputs</text>
  <text x="110" y="320" class="mono">lambda_role_arn</text>
  <text x="110" y="335" class="mono">private_subnet_ids</text>
  <text x="110" y="350" class="mono">lambda_security_group_ids</text>
  <text x="110" y="365" class="mono">rds_endpoint</text>
  <text x="110" y="380" class="mono">layer_arns</text>
  
  <!-- Lambda Functions -->
  <rect x="380" y="280" width="240" height="110" rx="5" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="500" y="300" class="box-title" text-anchor="middle">Lambda Functions</text>
  <text x="400" y="320" class="text">Functions:</text>
  <text x="410" y="335" class="small-text">- user-auth-function</text>
  <text x="410" y="348" class="small-text">- order-processing</text>
  <text x="410" y="361" class="small-text">- payment-service</text>
  <text x="400" y="380" class="text">Versions: $LATEST, v15, v16...</text>
  
  <!-- Aliases -->
  <rect x="660" y="280" width="240" height="110" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
  <text x="780" y="300" class="box-title" text-anchor="middle">Aliases</text>
  <rect x="680" y="310" width="200" height="20" rx="3" fill="#e1bee7" stroke="#9c27b0"/>
  <text x="690" y="325" class="small-text">development → $LATEST</text>
  <rect x="680" y="335" width="200" height="20" rx="3" fill="#ce93d8" stroke="#9c27b0"/>
  <text x="690" y="350" class="small-text">staging → v16</text>
  <rect x="680" y="360" width="200" height="20" rx="3" fill="#ba68c8" stroke="#9c27b0"/>
  <text x="690" y="375" class="small-text" fill="#fff">production → v15</text>
  
  <!-- Infrastructure Resources -->
  <rect x="100" y="420" width="240" height="120" rx="5" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="220" y="440" class="box-title" text-anchor="middle">Infrastructure</text>
  <text x="120" y="460" class="small-text">- VPC (Subnets, Security Groups)</text>
  <text x="120" y="475" class="small-text">- RDS (PostgreSQL/MySQL)</text>
  <text x="120" y="490" class="small-text">- S3 Buckets</text>
  <text x="120" y="505" class="small-text">- IAM Roles and Policies</text>
  <text x="120" y="520" class="small-text">- EventBridge, SQS/SNS</text>
  
  <!-- Lambda Layers -->
  <rect x="380" y="420" width="240" height="120" rx="5" fill="#fff" stroke="#1976d2" stroke-width="2"/>
  <text x="500" y="440" class="box-title" text-anchor="middle">Lambda Layers</text>
  <text x="400" y="465" class="text" font-weight="bold">dependencies-layer</text>
  <text x="410" y="480" class="small-text">boto3, requests, pandas</text>
  <text x="400" y="505" class="text" font-weight="bold">company-utils-layer</text>
  <text x="410" y="520" class="small-text">Internal shared code</text>
  
  <!-- Artifact Storage -->
  <rect x="660" y="420" width="240" height="120" rx="5" fill="#fff" stroke="#ff9800" stroke-width="2"/>
  <text x="780" y="440" class="box-title" text-anchor="middle">S3 Artifact Storage</text>
  <text x="680" y="460" class="small-text">Bucket: lambda-artifacts</text>
  <text x="680" y="475" class="small-text">Versioning: Enabled</text>
  <text x="680" y="490" class="small-text">Lifecycle: 90 days</text>
  <text x="680" y="515" class="text">Stores deployment packages</text>
  <text x="680" y="530" class="text">for rollback capability</text>
  
  <!-- Arrows -->
  <!-- terraform to Infrastructure -->
  <path d="M 290 180 L 220 280" stroke="#1976d2" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="240" y="220" class="small-text" fill="#1976d2">terraform apply</text>
  
  <!-- terraform to Outputs -->
  <path d="M 290 180 L 220 280" stroke="#1976d2" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- lambda-applications to Lambda Functions -->
  <path d="M 710 180 L 500 280" stroke="#4caf50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="580" y="220" class="small-text" fill="#4caf50">lambroll deploy</text>
  
  <!-- Outputs to Lambda Functions -->
  <path d="M 340 335 L 380 335" stroke="#ff9800" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="345" y="330" class="small-text" fill="#ff9800">env vars</text>
  
  <!-- Lambda Functions to Aliases -->
  <line x1="620" y1="335" x2="660" y2="335" stroke="#7b1fa2" stroke-width="2"/>
  
  <!-- Infrastructure to Lambda Functions (dashed) -->
  <path d="M 220 420 L 480 390" stroke="#999" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  <text x="320" y="400" class="small-text" fill="#999">provides resources</text>
  
  <!-- Layers to Lambda Functions (dashed) -->
  <path d="M 500 420 L 500 390" stroke="#999" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  <text x="510" y="405" class="small-text" fill="#999">attach</text>
  
  <!-- Legend -->
  <rect x="50" y="570" width="900" height="20" rx="3" fill="#e8eaf6"/>
  <text x="60" y="583" class="small-text" font-weight="bold">Key Points:</text>
  <text x="150" y="583" class="small-text">Terraform manages infrastructure + outputs | Lambroll deploys functions + aliases | Terraform outputs → env vars → function.jsonl</text>
</svg>
