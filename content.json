{"posts":[{"title":"Route53ã¨ã‚ªãƒ³ãƒ—ãƒ¬DNSã«ãŠã‘ã‚‹æ¡ä»¶ä»˜ããƒ•ã‚©ãƒ¯ãƒ¼ãƒ€ãƒ¼ã¨å§”ä»»ã®æ§‹æˆæ¯”è¼ƒ","text":"Route 53 ãƒªã‚¾ãƒ«ãƒãƒ¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ã£ãŸãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã¸ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å§”ä»»ã«ã¤ã„ã¦ã€Qiita(â€»)ã§è§£èª¬è¨˜äº‹ã‚’æ‹è¦‹ã—ã¦ãã®æ§‹æˆã‚’æ¡ä»¶ä»˜ããƒ•ã‚©ãƒ¯ãƒ¼ãƒ€ãƒ¼ã¨æ¯”ã¹ã‚‹ã¨ã©ã†ãªã‚‹ã‹æ§‹æˆå›³ã«è¡¨ã—ã¦ã¿ã¾ã—ãŸã€‚ ã“ã‚Œã¾ã§ã¯ã‚ªãƒ³ãƒ—ãƒ¬ç’°å¢ƒã®ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ¨©å¨ DNS ã‚µãƒ¼ãƒã§ç®¡ç†ã—ã¦ã„ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒã‚ã‚Šã€AWSã®Route53ã§ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç®¡ç†ã—ãŸã„å ´åˆã€Route 53 ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã‹ã‚‰ã®åå‰è§£æ±ºã‚¯ã‚¨ãƒªã‚’è»¢é€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ï¼ˆæ¡ä»¶ä»˜ããƒ•ã‚©ãƒ¯ãƒ¼ãƒ€ãƒ¼è¨­å®šï¼‰ Route 53 ãƒªã‚¾ãƒ«ãƒãƒ¼ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã¸ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å§”ä»»ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ Amazon Route 53 Resolver endpoints now support DNS delegation for private hosted zones æ¨™æº–çš„ãªDNSå§”ä»»æ§‹æˆã¨ãªã‚‹ã®ã§ã€æ¡ä»¶ä»˜ããƒ•ã‚©ãƒ¯ãƒ¼ãƒ€ãƒ¼ã‚ˆã‚Šã‚‚å§”ä»»è¨­å®šãŒæ¨å¥¨ã§ã™ãŒã€Route 53 ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å†ä½œæˆã«ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åœæ­¢ã‚’ä¼´ã†ç‚¹ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ (â€»)Route 53 ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã¸ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã® DNS ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å§”ä»»ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§è©¦ã—ã¦ã¿ãŸ","link":"/2025/06/29/dns_forward/"},{"title":"Lambda CI&#x2F;CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ - ç›®æ¬¡","text":"ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æˆæœ¬è¨­è¨ˆæ›¸ã¯ã€å¤§è¦æ¨¡Lambdaç’°å¢ƒã«ãŠã‘ã‚‹CI/CDã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆæ€æƒ³ã¨å®Ÿè£…æŒ‡é‡ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚ ğŸ“‘ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§ 1. CI/CDç’°å¢ƒæ§‹ç¯‰ã«ãŠã‘ã‚‹æ–¹é‡ãƒ•ã‚¡ã‚¤ãƒ«: 01_cicd_architecture_principles.md å†…å®¹: è¨­è¨ˆã®èƒŒæ™¯ã¨èª²é¡Œ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬æ–¹é‡ ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢æˆ¦ç•¥ ãƒ„ãƒ¼ãƒ«é¸å®šã®ç†ç”±ï¼ˆTerraform + SAM + GitHub Actionsï¼‰ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¨ã‚¬ãƒãƒŠãƒ³ã‚¹ã®è€ƒæ…® 2. å…·ä½“çš„ãªæ§‹æˆè¦ç´ ã¨å½¹å‰²ãƒ•ã‚¡ã‚¤ãƒ«: 02_architecture_components.md å†…å®¹: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³ ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆ å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è²¬ä»»ç¯„å›² Terraformï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ãƒªãƒã‚¸ãƒˆãƒªï¼‰ SAMï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒã‚¸ãƒˆãƒªï¼‰ GitHub Actionsï¼ˆCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰ ãƒªã‚½ãƒ¼ã‚¹é…ç½®ã®ãƒ«ãƒ¼ãƒ« ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç†æˆ¦ç•¥ 3. å„æ§‹æˆè¦ç´ ã®å®Ÿè£…ã«é–¢ã™ã‚‹ç•™æ„ç‚¹ãƒ•ã‚¡ã‚¤ãƒ«: 03_implementation_guidelines.md å†…å®¹: Terraformå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ IAMãƒ­ãƒ¼ãƒ«ãƒ»ãƒãƒªã‚·ãƒ¼ç®¡ç† VPCãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š SSM Parameter Storeæ´»ç”¨ SAMå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ Lambdaé–¢æ•°æ§‹æˆ Layerç®¡ç† ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®š GitHub Actionså®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ å¤‰æ›´æ¤œçŸ¥ã¨ãƒ‘ã‚¹æŒ‡å®š å‘½åè¦å‰‡ã¨ã‚¿ã‚°æˆ¦ç•¥ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é … 4. ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦èªè­˜ã™ã¹ãã“ã¨ãƒ•ã‚¡ã‚¤ãƒ«: 04_tradeoffs_and_considerations.md å†…å®¹: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨å¯¾ç­– ä»£æ›¿ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®æ¯”è¼ƒ ç§»è¡Œæˆ¦ç•¥ é‹ç”¨ä¸Šã®è€ƒæ…®äº‹é … ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰ ğŸ“Š å¯¾è±¡èª­è€… ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“ã®ç†è§£ã¨æ„æ€æ±ºå®š ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢: Terraformå®Ÿè£…ã¨ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç† ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢: SAMã«ã‚ˆã‚‹Lambdaé–‹ç™º DevOpsã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰ã¨é‹ç”¨ ğŸ¯ æƒ³å®šç’°å¢ƒ è¦æ¨¡: å¤§é‡ã®Lambdaé–¢æ•°ï¼ˆæ•°åã€œæ•°ç™¾ï¼‰ çµ„ç¹”: è¤‡æ•°ãƒãƒ¼ãƒ ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ã€ã‚¢ãƒ—ãƒªãƒãƒ¼ãƒ ï¼‰ æ—¢å­˜ç’°å¢ƒ: Terraform + GitHub Actions è¦ä»¶: ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢ æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ï¼ˆã‚«ãƒŠãƒªã‚¢ã€ãƒ–ãƒ«ãƒ¼ã‚°ãƒªãƒ¼ãƒ³ï¼‰ ã‚¬ãƒãƒŠãƒ³ã‚¹ï¼ˆæ‰¿èªãƒ•ãƒ­ãƒ¼ï¼‰ é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ğŸ“ èª­ã¿æ–¹ åˆã‚ã¦èª­ã‚€æ–¹: é †ç•ªã«1â†’2â†’3â†’4 è¨­è¨ˆæ€æƒ³ã‚’ç†è§£ã—ãŸã„æ–¹: 1â†’4 å®Ÿè£…æ–¹æ³•ã‚’çŸ¥ã‚ŠãŸã„æ–¹: 2â†’3 ç‰¹å®šã®ãƒˆãƒ”ãƒƒã‚¯ã‚’èª¿ã¹ãŸã„æ–¹: å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç›®æ¬¡ã‹ã‚‰ ğŸ”„ æ›´æ–°å±¥æ­´ æ—¥ä»˜ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ å¤‰æ›´å†…å®¹ æ›´æ–°è€… 2025-XX-XX 1.0.0 åˆç‰ˆä½œæˆ - æ¬¡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆğŸ‘‰ 1. CI/CDç’°å¢ƒæ§‹ç¯‰ã«ãŠã‘ã‚‹æ–¹é‡","link":"/2025/11/02/lambda-cicd-00-index/"},{"title":"sshdã®æ¥ç¶šå…ƒã‚’æ—¥æœ¬ã®IPã«é™å®šã™ã‚‹","text":"fetus å›½ï¼åœ°åŸŸåˆ¥IPã‚¢ãƒ‰ãƒ¬ã‚¹å‰²ã‚ŠæŒ¯ã‚Šä¸€è¦§ ã®IPãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã€SSHã®æ¥ç¶šå…ƒã‚’æ—¥æœ¬ã®IPã«é™å®š ç’°å¢ƒæƒ…å ± OS Ubuntu Version 24.04.2 LTS hosts.allowã¨hosts.denyã®è¨­å®š æœ€çµ‚è¡Œã¯æ”¹è¡ŒãŒå¿…è¦ã§ã™ï¼ˆæ”¹è¡ŒãŒãªã„ã¨æ­£å¸¸ã«å‹•ä½œã—ã¾ã›ã‚“ï¼‰ /etc/hosts.allow 12sshd: /etc/jp.allow /etc/hosts.deny 12ALL : ALL ã‚¹ã‚¯ãƒªãƒ—ãƒˆå¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å–å¾—ã—ã¾ã™ 1pip install requests jp_allow.py 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import requests# IPãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹URLURL = &quot;https://ipv4.fetus.jp/jp.txt&quot;def convert_subnet(cidr_value): ''' ã‚µãƒ–ãƒãƒƒãƒˆã‚’255.255.255.0å½¢å¼ã«å¤‰æ›ã™ã‚‹é–¢æ•° ''' subnet_map = { 8: &quot;255.0.0.0&quot;, 9: &quot;255.128.0.0&quot;, 10: &quot;255.192.0.0&quot;, 11: &quot;255.224.0.0&quot;, 12: &quot;255.240.0.0&quot;, 13: &quot;255.248.0.0&quot;, 14: &quot;255.252.0.0&quot;, 15: &quot;255.254.0.0&quot;, 16: &quot;255.255.0.0&quot;, 17: &quot;255.255.128.0&quot;, 18: &quot;255.255.192.0&quot;, 19: &quot;255.255.224.0&quot;, 20: &quot;255.255.240.0&quot;, 21: &quot;255.255.248.0&quot;, 22: &quot;255.255.252.0&quot;, 23: &quot;255.255.254.0&quot;, 24: &quot;255.255.255.0&quot;, 25: &quot;255.255.255.128&quot;, 26: &quot;255.255.255.192&quot;, 27: &quot;255.255.255.224&quot;, 28: &quot;255.255.255.240&quot;, 29: &quot;255.255.255.248&quot;, 30: &quot;255.255.255.252&quot;, 31: &quot;255.255.255.254&quot;, 32: &quot;255.255.255.255&quot; } return subnet_map.get(cidr_value)# URLã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—response = requests.get(URL, timeout=5)ip_data = response.text.splitlines()# jp.allowå½¢å¼ã«å¤‰æ›with open(&quot;/etc/jp.allow&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;) as file: output = [] for line in ip_data: if line and not line.startswith(&quot;#&quot;): # ã‚³ãƒ¡ãƒ³ãƒˆè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ— ip, cidr = line.split('/') subnet = convert_subnet(int(cidr)) output.append(f&quot;{ip}/{subnet}&quot;) file.write(&quot; &quot;.join(output)) # ã‚¹ãƒšãƒ¼ã‚¹ã§åŒºåˆ‡ã£ã¦æ›¸ãè¾¼ã¿print(&quot;IPãƒªã‚¹ãƒˆãŒjp.allowãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã•ã‚Œã¾ã—ãŸã€‚&quot;) å®Ÿè¡Œ /etc ã«æ›¸ãè¾¼ã‚€ãŸã‚ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ 1sudo python jp_allow.py æ³¨æ„ hosts.allowã¨hosts.denyã¯æ¥ç¶šã®åº¦ã«å‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã®ã§ã€åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ç­‰ã§è©¦è¡Œã—ã¦ã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ‡æ–­ã—ã¦ãã ã•ã„","link":"/2025/06/23/jp_allow/"},{"title":"Lambda CI&#x2F;CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - 1. ç’°å¢ƒæ§‹ç¯‰ã«ãŠã‘ã‚‹æ–¹é‡","text":"ç›®æ¬¡ è¨­è¨ˆã®èƒŒæ™¯ã¨èª²é¡Œ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬æ–¹é‡ ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢æˆ¦ç•¥ ãƒ„ãƒ¼ãƒ«é¸å®šã®ç†ç”± ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¨ã‚¬ãƒãƒŠãƒ³ã‚¹ è¨­è¨ˆã®èƒŒæ™¯ã¨èª²é¡Œ ç¾çŠ¶ã®èª²é¡Œèªè­˜å¤§è¦æ¨¡Lambdaç’°å¢ƒã«ãŠã‘ã‚‹å…¸å‹çš„ãªèª²é¡Œï¼š 1. ç®¡ç†ã®è¤‡é›‘æ€§èª²é¡Œ: æ•°åã€œæ•°ç™¾ã®Lambdaé–¢æ•°ãŒå­˜åœ¨ å„é–¢æ•°ã®ä¾å­˜é–¢ä¿‚ç®¡ç†ãŒç…©é›‘ Layerç®¡ç†ãŒå±äººåŒ– ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„ å½±éŸ¿: ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ã®å¢—å¤§ æœ¬ç•ªéšœå®³ã®ãƒªã‚¹ã‚¯å¢—åŠ  æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼ã®ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å›°é›£ 2. ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®æ··åŒèª²é¡Œ: ã‚³ãƒ¼ãƒ‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ = æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹ ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡ã§ããªã„ æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ãŒå›°é›£ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«æ™‚é–“ãŒã‹ã‹ã‚‹ å½±éŸ¿: æœ¬ç•ªç’°å¢ƒã¸ã®å½±éŸ¿ãƒªã‚¹ã‚¯ å¤œé–“ãƒ»ä¼‘æ—¥ãƒ‡ãƒ—ãƒ­ã‚¤ã®å¢—åŠ  ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã¨ã®ä¸æ•´åˆ 3. çµ„ç¹”çš„ãªèª²é¡Œèª²é¡Œ: ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ã¨ã‚¢ãƒ—ãƒªãƒãƒ¼ãƒ ã®è²¬ä»»ç¯„å›²ãŒæ›–æ˜§ æ‰¿èªãƒ•ãƒ­ãƒ¼ãŒä¸æ˜ç¢º ã‚¬ãƒãƒŠãƒ³ã‚¹ãŒåŠ¹ã„ã¦ã„ãªã„ å½±éŸ¿: ãƒ‡ãƒ—ãƒ­ã‚¤ã®é…å»¶ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å•é¡Œ 4. æ—¢å­˜ç’°å¢ƒã®åˆ¶ç´„çŠ¶æ³: æ—¢ã«Terraformã§å¤§éƒ¨åˆ†ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ç®¡ç† GitHub Actionsã§CI/CDæ§‹ç¯‰æ¸ˆã¿ å…¨ã¦ã‚’åˆ·æ–°ã™ã‚‹ã®ã¯ç¾å®Ÿçš„ã§ãªã„ è¦ä»¶: æ—¢å­˜è³‡ç”£ã‚’æ´»ç”¨ æ®µéšçš„ãªç§»è¡Œ ãƒãƒ¼ãƒ ã¸ã®è² è·ã‚’æœ€å°åŒ– ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬æ–¹é‡1. é–¢å¿ƒã®åˆ†é›¢ï¼ˆSeparation of Concernsï¼‰åŸå‰‡:ç•°ãªã‚‹ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’æŒã¤ã‚‚ã®ã¯ã€ç•°ãªã‚‹ãƒ„ãƒ¼ãƒ«ã§ç®¡ç†ã™ã‚‹ å®Ÿè£…: Terraformï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ï¼‰ IAMã€VPCã€RDSç­‰ å¤‰æ›´é »åº¦: ä½ï¼ˆæœˆ1å›ä»¥ä¸‹ï¼‰ ç®¡ç†è€…: ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ  SAMï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ Lambdaé–¢æ•°ã€Layer å¤‰æ›´é »åº¦: é«˜ï¼ˆé€±1å›ä»¥ä¸Šï¼‰ ç®¡ç†è€…: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒ  ãƒ¡ãƒªãƒƒãƒˆ:âœ“ ãƒ‡ãƒ—ãƒ­ã‚¤ã®ç‹¬ç«‹æ€§ï¼ˆäº’ã„ã«å½±éŸ¿ã—ãªã„ï¼‰âœ“ ãƒãƒ¼ãƒ é–“ã®è²¬ä»»ç¯„å›²ãŒæ˜ç¢ºâœ“ é©åˆ‡ãªãƒ„ãƒ¼ãƒ«ã§é©åˆ‡ãªç®¡ç† 2. ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢å®šç¾©:ãƒ‡ãƒ—ãƒ­ã‚¤ (Deploy): ã‚³ãƒ¼ãƒ‰ã‚’AWSã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹è¡Œç‚º æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½œæˆ æœ¬ç•ªç’°å¢ƒã«ã¯å½±éŸ¿ã—ãªã„ ãƒªãƒªãƒ¼ã‚¹ (Release): ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å…¬é–‹ã™ã‚‹è¡Œç‚º ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æµã‚Œã‚‹ é‡è¦ãªåŸå‰‡:ãƒ‡ãƒ—ãƒ­ã‚¤ â‰  ãƒªãƒªãƒ¼ã‚¹ å®Ÿè£…: ã‚¢ãƒ—ãƒªãƒãƒ¼ãƒ : ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆstagingè‡ªå‹•ï¼‰ QA: stagingç’°å¢ƒã§æ¤œè¨¼ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ : æ‰¿èªå¾Œã«productionãƒªãƒªãƒ¼ã‚¹ ç›£è¦–: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç¢ºèª å•é¡Œã‚ã‚Œã°: ç¬æ™‚ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆï¼‰ 3. Infrastructure as Code ã®å¾¹åº•åŸå‰‡:å…¨ã¦ã®è¨­å®šã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç†ã—ã€Gitã§è¿½è·¡å¯èƒ½ã«ã™ã‚‹ å®Ÿè£…: Terraform: ã‚¤ãƒ³ãƒ•ãƒ©ãƒªã‚½ãƒ¼ã‚¹ SAM: Lambdaé–¢æ•°ã¨ãã®è¨­å®š GitHub Actions: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ SSM Parameter Store: ç’°å¢ƒé–“ã®å…±æœ‰å€¤ ãƒ¡ãƒªãƒƒãƒˆ:âœ“ å¤‰æ›´å±¥æ­´ã®è¿½è·¡âœ“ ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆPull Requestï¼‰âœ“ ç’°å¢ƒã®å†ç¾æ€§âœ“ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å®¹æ˜“æ€§ 4. æ®µéšçš„ãªç’°å¢ƒæ§‹æˆç’°å¢ƒæ§‹æˆ: Developmentï¼ˆé–‹ç™ºï¼‰: Lambda: $LATESTï¼ˆå¸¸ã«æœ€æ–°ï¼‰ ç”¨é€”: é–‹ç™ºè€…ã®å‹•ä½œç¢ºèª ãƒ‡ãƒ—ãƒ­ã‚¤: ãƒ—ãƒƒã‚·ãƒ¥æ™‚ã«è‡ªå‹• Stagingï¼ˆæ¤œè¨¼ï¼‰: Lambda: æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆè‡ªå‹•æ›´æ–°ï¼‰ ç”¨é€”: QAã€çµ±åˆãƒ†ã‚¹ãƒˆ ãƒ‡ãƒ—ãƒ­ã‚¤: main mergĞµæ™‚ã«è‡ªå‹• Productionï¼ˆæœ¬ç•ªï¼‰: Lambda: æ‰¿èªã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ ç”¨é€”: ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ ãƒ‡ãƒ—ãƒ­ã‚¤: æ‰‹å‹•æ‰¿èªå¾Œã«ãƒªãƒªãƒ¼ã‚¹ åˆ©ç‚¹:âœ“ æ®µéšçš„ãªæ¤œè¨¼âœ“ æœ¬ç•ªãƒªã‚¹ã‚¯ã®æœ€å°åŒ–âœ“ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥ã®æ˜ç¢ºåŒ– ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢æˆ¦ç•¥ãªãœåˆ†é›¢ãŒå¿…è¦ã‹ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã¨ã®æ•´åˆã‚±ãƒ¼ã‚¹1: ã‚¿ã‚¤ãƒ ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªæ©Ÿèƒ½ã‚·ãƒŠãƒªã‚ª: æ–°æ©Ÿèƒ½ã‚’äº‹å‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤ ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å§‹æ™‚åˆ»ã«ãƒªãƒªãƒ¼ã‚¹ï¼ˆä¾‹: 0æ™‚ï¼‰ å¾“æ¥ã®å•é¡Œ:ãƒ‡ãƒ—ãƒ­ã‚¤ = ãƒªãƒªãƒ¼ã‚¹â†’ 0æ™‚ã«ä½œæ¥­ãŒå¿…è¦â†’ æ·±å¤œãƒ»ä¼‘æ—¥ä½œæ¥­ åˆ†é›¢å¾Œ: äº‹å‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆå–¶æ¥­æ™‚é–“å†…ï¼‰ 0æ™‚ã«ã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆï¼ˆè‡ªå‹•åŒ–å¯èƒ½ï¼‰â†’ æ·±å¤œä½œæ¥­ä¸è¦ ãƒªã‚¹ã‚¯ç®¡ç†ã‚±ãƒ¼ã‚¹2: æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹è¦ä»¶: ã¾ãš10%ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ†ã‚¹ãƒˆ å•é¡Œãªã‘ã‚Œã°100%ã«æ‹¡å¤§ å®Ÿè£…: ãƒ‡ãƒ—ãƒ­ã‚¤: æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹: 10%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ ç›£è¦–: ã‚¨ãƒ©ãƒ¼ç‡ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ç¢ºèªï¼ˆ10åˆ†ï¼‰ å•é¡Œãªã—: 100%ã«åˆ‡ã‚Šæ›¿ãˆ å•é¡Œã‚ã‚Š: å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ ãƒ¡ãƒªãƒƒãƒˆ:âœ“ æœ¬ç•ªå½±éŸ¿ã®æœ€å°åŒ–âœ“ å•é¡Œã®æ—©æœŸç™ºè¦‹âœ“ è¿…é€Ÿãªãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ å®Ÿè£…ãƒ¡ã‚«ãƒ‹ã‚ºãƒ Lambda ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚³ãƒ³ã‚»ãƒ—ãƒˆ: Lambdaé–¢æ•°â”œâ”€â”€ $LATESTï¼ˆæœ€æ–°ã‚³ãƒ¼ãƒ‰ï¼‰â”œâ”€â”€ Version 14ï¼ˆä¸å¤‰ï¼‰â”œâ”€â”€ Version 15ï¼ˆä¸å¤‰ï¼‰â””â”€â”€ Version 16ï¼ˆä¸å¤‰ï¼‰â† æœ€æ–°ãƒ‡ãƒ—ãƒ­ã‚¤ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆãƒã‚¤ãƒ³ã‚¿ï¼‰â”œâ”€â”€ development â†’ $LATESTâ”œâ”€â”€ staging â†’ Version 16â””â”€â”€ production â†’ Version 15 â† æœ¬ç•ªã¯ã¾ã æ—§ç‰ˆ ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚: ã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆ$LATESTæ›´æ–°ï¼‰ publish-versionï¼ˆVersion 16ä½œæˆï¼‰ staging ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ›´æ–° production ã¯å¤‰æ›´ãªã— â† å½±éŸ¿ãªã— ãƒªãƒªãƒ¼ã‚¹æ™‚: production ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ Version 16 ã«åˆ‡ã‚Šæ›¿ãˆ æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æµã‚Œã‚‹ æ•°ç§’ã§å®Œäº† ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚: production ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ Version 15 ã«æˆ»ã™ æ•°ç§’ã§æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¾©å¸° ãƒ„ãƒ¼ãƒ«é¸å®šã®ç†ç”±Terraformï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ï¼‰é¸å®šç†ç”±âœ“ æ—¢å­˜è³‡ç”£ æ—¢ã«å¤§éƒ¨åˆ†ã®ã‚¤ãƒ³ãƒ•ãƒ©ã§ä½¿ç”¨ä¸­ ãƒãƒ¼ãƒ ã®ç¿’ç†Ÿåº¦ãŒé«˜ã„ å®Ÿç¸¾ã¨ãƒŠãƒ¬ãƒƒã‚¸ã®è“„ç© âœ“ ãƒãƒ«ãƒãƒªã‚½ãƒ¼ã‚¹å¯¾å¿œ VPCã€RDSã€S3ç­‰ã‚’çµ±åˆç®¡ç† Lambdaã ã‘ã§ãªãå…¨ä½“ã‚’ä¿¯ç° âœ“ çŠ¶æ…‹ç®¡ç† terraform.tfstate ã§ç¾çŠ¶ã‚’æŠŠæ¡ plan ã§å¤‰æ›´å½±éŸ¿ã‚’äº‹å‰ç¢ºèª âœ“ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ– å†åˆ©ç”¨å¯èƒ½ãªæ§‹æˆ çµ„ç¹”æ¨™æº–ã®ç¢ºç«‹ Lambdaã«ã¯ä½¿ã‚ãªã„ç†ç”±âœ— Lambdaå°‚ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ãªã„ ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ãŒç…©é›‘ Layerç®¡ç†ãŒé¢å€’ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãŒå›°é›£ âœ— ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé…ã„ plan/apply ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ å…¨ãƒªã‚½ãƒ¼ã‚¹ã®ãƒã‚§ãƒƒã‚¯ Lambdaæ›´æ–°ã«æ•°åˆ†ä»¥ä¸Š âœ— é–‹ç™ºè€…ä½“é¨“ ã‚¢ãƒ—ãƒªé–‹ç™ºè€…ã«Terraformã‚’å¼·åˆ¶ å­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„ ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦ãŒä½ä¸‹ SAMï¼ˆLambdaç®¡ç†ï¼‰é¸å®šç†ç”±âœ“ Lambdaå°‚ç”¨ã«æœ€é©åŒ– sam build ã§è‡ªå‹•ãƒ“ãƒ«ãƒ‰ Layerç®¡ç†ãŒç°¡å˜ ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•è§£æ±º âœ“ é–‹ç™ºè€…ä½“é¨“ sam local ã§å±€æ‰€ãƒ†ã‚¹ãƒˆ ã‚·ãƒ³ãƒ—ãƒ«ãªYAMLè¨­å®š é«˜é€Ÿãªãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ1-2åˆ†ï¼‰ âœ“ AWSå…¬å¼ã‚µãƒãƒ¼ãƒˆ CloudFormationãƒ™ãƒ¼ã‚¹ AWSãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ç¶™ç¶šçš„ãªæ©Ÿèƒ½è¿½åŠ  âœ“ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç† AutoPublishAliasæ©Ÿèƒ½ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ ã‚«ãƒŠãƒªã‚¢ãƒ‡ãƒ—ãƒ­ã‚¤æ¨™æº–è£…å‚™ ä»–ãƒ„ãƒ¼ãƒ«ã¨ã®æ¯”è¼ƒvs Serverless Framework:SAMã‚’é¸ã‚“ã ç†ç”±: AWSå…¬å¼ï¼ˆé•·æœŸã‚µãƒãƒ¼ãƒˆä¿è¨¼ï¼‰ CloudFormationã¨ã®è¦ªå’Œæ€§ å­¦ç¿’ã‚³ã‚¹ãƒˆãŒä½ã„ AWSçµ±åˆï¼ˆX-Rayã€CloudWatchç­‰ï¼‰ vs Terraformï¼ˆLambdaç®¡ç†ï¼‰:SAMã‚’é¸ã‚“ã ç†ç”±: Lambdaç‰¹åŒ–ã®æ©Ÿèƒ½ ãƒ‡ãƒ—ãƒ­ã‚¤é€Ÿåº¦ï¼ˆ10å€ä»¥ä¸Šé«˜é€Ÿï¼‰ é–‹ç™ºè€…ä½“é¨“ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆç’°å¢ƒ GitHub Actionsï¼ˆCI/CDï¼‰é¸å®šç†ç”±âœ“ æ—¢å­˜è³‡ç”£ æ—¢ã«CI/CDã§ä½¿ç”¨ä¸­ GitHub Enterpriseåˆ©ç”¨ âœ“ GitHubãƒã‚¤ãƒ†ã‚£ãƒ– Pull Requesté€£å‹• ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ•ãƒ­ãƒ¼çµ±åˆ Secretsã‚¹ãƒˆã‚¢ âœ“ æŸ”è»Ÿæ€§ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç† è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚‚å®Ÿè£…å¯èƒ½ å†åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ âœ“ ã‚³ã‚¹ãƒˆ GitHub Enterpriseå¥‘ç´„å†… è¿½åŠ ã‚³ã‚¹ãƒˆä¸è¦ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¨ã‚¬ãƒãƒŠãƒ³ã‚¹ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¸ã®å¯¾å¿œé–¢æ•°æ•°ã®å¢—åŠ èª²é¡Œ: 100å€‹ä»¥ä¸Šã®Lambdaé–¢æ•° å¯¾ç­–: é–¢æ•°ã®ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°â”œâ”€â”€ auth-functionsâ”œâ”€â”€ data-functionsâ”œâ”€â”€ api-functionsâ””â”€â”€ batch-functions ä¸¦åˆ—ãƒ‡ãƒ—ãƒ­ã‚¤ å„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä¸¦åˆ—å®Ÿè¡Œ ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ã®çŸ­ç¸® é¸æŠçš„ãƒ‡ãƒ—ãƒ­ã‚¤ å¤‰æ›´æ¤œçŸ¥ï¼ˆgit diffï¼‰ å½±éŸ¿ç¯„å›²ã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒãƒ¼ãƒ æ•°ã®å¢—åŠ èª²é¡Œ: è¤‡æ•°ãƒãƒ¼ãƒ ã§ã®Lambdaé–‹ç™º å¯¾ç­–: ãƒªãƒã‚¸ãƒˆãƒªåˆ†é›¢team-a-lambdas/team-b-lambdas/team-c-lambdas/ å…±é€šåŸºç›¤ã®æä¾› å…±é€šLayerï¼ˆTerraformã§ç®¡ç†ï¼‰ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ç‹¬ç«‹ã—ãŸãƒ‡ãƒ—ãƒ­ã‚¤ ãƒãƒ¼ãƒ é–“ã®ä¾å­˜ã‚’æœ€å°åŒ– ä¸¦è¡Œé–‹ç™ºã‚’å¯èƒ½ã« ã‚¬ãƒãƒŠãƒ³ã‚¹ã®ç¢ºä¿æ‰¿èªãƒ•ãƒ­ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¸ã”ã¨ã®æ‰¿èªãƒ¬ãƒ™ãƒ«: Development: æ‰¿èª: ä¸è¦ ãƒ‡ãƒ—ãƒ­ã‚¤: è‡ªå‹•ï¼ˆãƒ—ãƒƒã‚·ãƒ¥æ™‚ï¼‰ ãƒªã‚¹ã‚¯: ä½ Staging: æ‰¿èª: Pull Requestæ‰¿èª ãƒ‡ãƒ—ãƒ­ã‚¤: è‡ªå‹•ï¼ˆmergeæ™‚ï¼‰ ãƒªã‚¹ã‚¯: ä½ Production: æ‰¿èª: å¿…é ˆ Pull Requestæ‰¿èªï¼ˆã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ ãƒªãƒªãƒ¼ã‚¹ç”³è«‹ï¼ˆSlackç­‰ï¼‰ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ æ‰¿èª ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ ãƒ‡ãƒ—ãƒ­ã‚¤: æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ ãƒªã‚¹ã‚¯: é«˜ ç›£æŸ»è¨¼è·¡è¨˜éŒ²ã™ã‚‹æƒ…å ±: Git commitï¼ˆã‚³ãƒ¼ãƒ‰å¤‰æ›´ï¼‰ GitHub Actionså®Ÿè¡Œãƒ­ã‚° Lambda ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç™ºè¡Œå±¥æ­´ ã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆå±¥æ­´ SSM Parameter Storeå¤‰æ›´å±¥æ­´ CloudWatch Logs ç”¨é€”: å•é¡Œç™ºç”Ÿæ™‚ã®åŸå› èª¿æŸ» ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†åŸå‰‡: æœ€å°æ¨©é™ã®åŸå‰‡ ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†ã®å¾¹åº• å®Ÿè£…: IAMãƒ­ãƒ¼ãƒ«ï¼ˆTerraformã§ç®¡ç†ï¼‰ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹å¿…é ˆ GitHub Secrets AWSèªè¨¼æƒ…å ± API Keyç­‰ Secrets Manager / SSM Parameter Store å®Ÿè¡Œæ™‚ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ æš—å·åŒ–å¿…é ˆ OIDCã«ã‚ˆã‚‹èªè¨¼ é•·æœŸèªè¨¼æƒ…å ±ã®æ’é™¤ å‹•çš„ãªæ¨©é™ä»˜ä¸ æ–¹é‡ã®ã¾ã¨ã‚æ ¸å¿ƒçš„ãªåŸå‰‡ é–¢å¿ƒã®åˆ†é›¢ Terraform: ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆä½é »åº¦å¤‰æ›´ï¼‰ SAM: Lambdaï¼ˆé«˜é »åº¦å¤‰æ›´ï¼‰ ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢ ãƒ‡ãƒ—ãƒ­ã‚¤: è‡ªç”±ã«ã€é »ç¹ã« ãƒªãƒªãƒ¼ã‚¹: æ…é‡ã«ã€æ‰¿èªå¾Œã« Infrastructure as Code å…¨ã¦ã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç† Gitã§è¿½è·¡å¯èƒ½ æ®µéšçš„ãªæ¤œè¨¼ development â†’ staging â†’ production å„ç’°å¢ƒã§ç¢ºèª é©åˆ‡ãªãƒ„ãƒ¼ãƒ«é¸æŠ æ—¢å­˜è³‡ç”£ã®æ´»ç”¨ Lambdaç‰¹åŒ–ãƒ„ãƒ¼ãƒ«ï¼ˆSAMï¼‰ã®å°å…¥ é”æˆã•ã‚Œã‚‹ä¾¡å€¤é–‹ç™ºãƒãƒ¼ãƒ :âœ“ é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³âœ“ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆç’°å¢ƒâœ“ ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­å®š ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ :âœ“ ã‚¬ãƒãƒŠãƒ³ã‚¹ã®ç¢ºä¿âœ“ ãƒªãƒªãƒ¼ã‚¹åˆ¶å¾¡âœ“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç† ãƒ“ã‚¸ãƒã‚¹:âœ“ ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®åˆ¶å¾¡âœ“ ãƒªã‚¹ã‚¯ã®æœ€å°åŒ–âœ“ è¿…é€Ÿãªãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ çµ„ç¹”å…¨ä½“:âœ“ æ˜ç¢ºãªè²¬ä»»ç¯„å›²âœ“ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£âœ“ ç›£æŸ»è¨¼è·¡ã®ç¢ºä¿ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã“ã®æ–¹é‡ã‚’å…·ä½“çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«è½ã¨ã—è¾¼ã¿ã¾ã™ã€‚ ğŸ‘‰ æ¬¡ã¸: 2. å…·ä½“çš„ãªæ§‹æˆè¦ç´ ã¨å½¹å‰²","link":"/2025/11/02/lambda-cicd-01-principles/"},{"title":"Lambda CI&#x2F;CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - 2. æ§‹æˆè¦ç´ ã¨å½¹å‰²","text":"ç›®æ¬¡ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³ ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆ å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è²¬ä»»ç¯„å›² ãƒªã‚½ãƒ¼ã‚¹é…ç½®ã®ãƒ«ãƒ¼ãƒ« ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç†æˆ¦ç•¥ é€£æºãƒ¡ã‚«ãƒ‹ã‚ºãƒ  ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆterraform-infrastructureï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ãƒªãƒã‚¸ãƒˆãƒªï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960terraform-infrastructure/â”œâ”€â”€ README.mdâ”œâ”€â”€ .github/â”‚ â””â”€â”€ workflows/â”‚ â”œâ”€â”€ terraform-plan.yml # PRæ™‚ã®planâ”‚ â”œâ”€â”€ terraform-apply.yml # mergeæ™‚ã®applyâ”‚ â””â”€â”€ lambda-release.yml # æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹â”‚â”œâ”€â”€ environments/ # ç’°å¢ƒåˆ¥è¨­å®šâ”‚ â”œâ”€â”€ production/â”‚ â”‚ â”œâ”€â”€ backend.tfâ”‚ â”‚ â”œâ”€â”€ terraform.tfvarsâ”‚ â”‚ â””â”€â”€ main.tfâ”‚ â”œâ”€â”€ staging/â”‚ â””â”€â”€ development/â”‚â”œâ”€â”€ modules/ # å†åˆ©ç”¨å¯èƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«â”‚ â”œâ”€â”€ vpc/â”‚ â”‚ â”œâ”€â”€ main.tfâ”‚ â”‚ â”œâ”€â”€ variables.tfâ”‚ â”‚ â””â”€â”€ outputs.tfâ”‚ â”œâ”€â”€ rds/â”‚ â”œâ”€â”€ lambda-role/â”‚ â””â”€â”€ shared-bucket/â”‚â”œâ”€â”€ iam/ # IAMç®¡ç†â”‚ â”œâ”€â”€ lambda-roles.tf # Lambdaå®Ÿè¡Œãƒ­ãƒ¼ãƒ«â”‚ â”œâ”€â”€ lambda-policies.tf # ãƒãƒªã‚·ãƒ¼â”‚ â””â”€â”€ outputs.tfâ”‚â”œâ”€â”€ vpc/ # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯â”‚ â”œâ”€â”€ main.tfâ”‚ â”œâ”€â”€ subnets.tfâ”‚ â”œâ”€â”€ security-groups.tfâ”‚ â””â”€â”€ outputs.tfâ”‚â”œâ”€â”€ data-stores/ # ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢â”‚ â”œâ”€â”€ rds.tfâ”‚ â”œâ”€â”€ dynamodb.tfâ”‚ â”œâ”€â”€ s3.tfâ”‚ â””â”€â”€ outputs.tfâ”‚â”œâ”€â”€ messaging/ # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°â”‚ â”œâ”€â”€ sqs.tfâ”‚ â”œâ”€â”€ sns.tfâ”‚ â”œâ”€â”€ eventbridge-pipes.tfâ”‚ â””â”€â”€ outputs.tfâ”‚â”œâ”€â”€ shared-values/ # å…±æœ‰å€¤ç®¡ç†â”‚ â”œâ”€â”€ main.tf # SSM Parameterå‡ºåŠ›â”‚ â””â”€â”€ outputs.tfâ”‚â”œâ”€â”€ lambda-aliases/ # ã‚¨ã‚¤ãƒªã‚¢ã‚¹å®šç¾©â”‚ â”œâ”€â”€ aliases.tf # ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãƒªã‚½ãƒ¼ã‚¹â”‚ â””â”€â”€ variables.tfâ”‚â””â”€â”€ scripts/ # é‹ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ â”œâ”€â”€ release-lambda.sh # ãƒªãƒªãƒ¼ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ â”œâ”€â”€ rollback-lambda.sh # ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ â””â”€â”€ canary-release.sh # ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹ lambda-applicationsï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒã‚¸ãƒˆãƒªï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546lambda-applications/â”œâ”€â”€ README.mdâ”œâ”€â”€ .github/â”‚ â””â”€â”€ workflows/â”‚ â”œâ”€â”€ deploy-staging.yml # stagingè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤â”‚ â”œâ”€â”€ deploy-production.yml # productionç”³è«‹â”‚ â””â”€â”€ run-tests.yml # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œâ”‚â”œâ”€â”€ template.yaml # SAMãƒ¡ã‚¤ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆâ”œâ”€â”€ samconfig.toml # SAMè¨­å®šâ”‚â”œâ”€â”€ functions/ # Lambdaé–¢æ•°â”‚ â”œâ”€â”€ auth/â”‚ â”‚ â”œâ”€â”€ login/â”‚ â”‚ â”‚ â”œâ”€â”€ app.pyâ”‚ â”‚ â”‚ â”œâ”€â”€ requirements.txtâ”‚ â”‚ â”‚ â””â”€â”€ tests/â”‚ â”‚ â”œâ”€â”€ logout/â”‚ â”‚ â””â”€â”€ refresh-token/â”‚ â”‚â”‚ â”œâ”€â”€ orders/â”‚ â”‚ â”œâ”€â”€ create-order/â”‚ â”‚ â”œâ”€â”€ update-order/â”‚ â”‚ â””â”€â”€ cancel-order/â”‚ â”‚â”‚ â”œâ”€â”€ payments/â”‚ â””â”€â”€ notifications/â”‚â”œâ”€â”€ layers/ # Lambda Layerâ”‚ â”œâ”€â”€ dependencies/â”‚ â”‚ â”œâ”€â”€ python/â”‚ â”‚ â””â”€â”€ requirements.txtâ”‚ â””â”€â”€ company-utils/â”‚ â””â”€â”€ python/â”‚ â””â”€â”€ company/â”‚ â”œâ”€â”€ logger.pyâ”‚ â”œâ”€â”€ auth.pyâ”‚ â””â”€â”€ database.pyâ”‚â”œâ”€â”€ tests/ # çµ±åˆãƒ†ã‚¹ãƒˆâ”‚ â”œâ”€â”€ integration/â”‚ â””â”€â”€ e2e/â”‚â””â”€â”€ docs/ # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ â”œâ”€â”€ architecture.md â””â”€â”€ deployment.md å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è²¬ä»»ç¯„å›²Terraformï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ãƒªãƒã‚¸ãƒˆãƒªï¼‰ç®¡ç†å¯¾è±¡è²¬ä»»ç¯„å›²: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å…¨èˆ¬: - VPCã€ã‚µãƒ–ãƒãƒƒãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— - RDSã€DynamoDBã€ElastiCache - S3ãƒã‚±ãƒƒãƒˆï¼ˆå…±æœ‰ï¼‰ - IAMãƒ­ãƒ¼ãƒ«ã€ãƒãƒªã‚·ãƒ¼ - Secrets Managerã€SSM Parameter Store - EventBridge Pipes - SQS/SNSï¼ˆå…±æœ‰ï¼‰ - API Gatewayï¼ˆè¤‡é›‘ãªæ§‹æˆã®å ´åˆï¼‰ Lambdaé–¢é€£ï¼ˆé™å®šçš„ï¼‰: - Lambdaå®Ÿè¡Œãƒ­ãƒ¼ãƒ« - ã‚¨ã‚¤ãƒªã‚¢ã‚¹å®šç¾©ï¼ˆæ çµ„ã¿ï¼‰ - èªè¨¼Lambdaï¼ˆAPI Gateway Authorizerç­‰ï¼‰ - ç›£è¦–Lambdaï¼ˆãƒ­ã‚°é›†ç´„ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ï¼‰ ç®¡ç†ã—ãªã„ã‚‚ã®: Lambdaé–¢æ•°ã‚³ãƒ¼ãƒ‰ Lambda Layerï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰ Lambdaå°‚ç”¨ãƒªã‚½ãƒ¼ã‚¹ï¼ˆé »ç¹ã«å¤‰æ›´ï¼‰ å‡ºåŠ›å€¤ï¼ˆSSM Parameter Storeï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# terraform-infrastructure/shared-values/main.tf# IAMresource &quot;aws_ssm_parameter&quot; &quot;lambda_execution_role_arn&quot; { name = &quot;/shared/iam/lambda-execution-role-arn&quot; type = &quot;String&quot; value = aws_iam_role.lambda_execution.arn}# VPCresource &quot;aws_ssm_parameter&quot; &quot;vpc_subnet_ids&quot; { name = &quot;/shared/vpc/private-subnet-ids&quot; type = &quot;StringList&quot; value = join(&quot;,&quot;, aws_subnet.private[*].id)}resource &quot;aws_ssm_parameter&quot; &quot;vpc_security_group_id&quot; { name = &quot;/shared/vpc/lambda-security-group-id&quot; type = &quot;String&quot; value = aws_security_group.lambda.id}# ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢resource &quot;aws_ssm_parameter&quot; &quot;rds_endpoint&quot; { name = &quot;/shared/rds/endpoint&quot; type = &quot;String&quot; value = aws_db_instance.main.endpoint}resource &quot;aws_ssm_parameter&quot; &quot;dynamodb_table_name&quot; { name = &quot;/shared/dynamodb/orders-table-name&quot; type = &quot;String&quot; value = aws_dynamodb_table.orders.name}# S3resource &quot;aws_ssm_parameter&quot; &quot;data_bucket_name&quot; { name = &quot;/shared/s3/data-bucket-name&quot; type = &quot;String&quot; value = aws_s3_bucket.data.id}# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°resource &quot;aws_ssm_parameter&quot; &quot;notification_topic_arn&quot; { name = &quot;/shared/sns/notification-topic-arn&quot; type = &quot;String&quot; value = aws_sns_topic.notifications.arn} SAMï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒã‚¸ãƒˆãƒªï¼‰ç®¡ç†å¯¾è±¡è²¬ä»»ç¯„å›²: Lambdaé–¢æ•°: - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£… - é–¢æ•°è¨­å®šï¼ˆãƒ¡ãƒ¢ãƒªã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç­‰ï¼‰ - ç’°å¢ƒå¤‰æ•° - ãƒˆãƒªã‚¬ãƒ¼è¨­å®š Lambda Layer: - ä¾å­˜é–¢ä¿‚Layerï¼ˆpipã€npmç­‰ï¼‰ - å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£Layer - Layerã®ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ Lambdaå°‚ç”¨ãƒªã‚½ãƒ¼ã‚¹: - å°‚ç”¨SQSã‚­ãƒ¥ãƒ¼ï¼ˆé »ç¹ã«èª¿æ•´ï¼‰ - å°‚ç”¨EventBridgeãƒ«ãƒ¼ãƒ« - å°‚ç”¨DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå°è¦æ¨¡ï¼‰ ã‚¨ã‚¤ãƒªã‚¢ã‚¹: - stagingã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆè‡ªå‹•æ›´æ–°ï¼‰ - productionã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆå®šç¾©ã®ã¿ï¼‰ ç®¡ç†ã—ãªã„ã‚‚ã®: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ï¼ˆVPCã€RDSç­‰ï¼‰ IAMãƒ­ãƒ¼ãƒ«ï¼ˆå®Ÿè¡Œãƒ­ãƒ¼ãƒ«ï¼‰ å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹ SAMãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹é€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990# lambda-applications/template.yamlAWSTemplateFormatVersion: '2010-09-09'Transform: AWS::Serverless-2016-10-31Parameters: # Terraformã‹ã‚‰å–å¾—ã™ã‚‹å€¤ LambdaExecutionRoleArn: Type: AWS::SSM::Parameter::Value&lt;String&gt; Default: /shared/iam/lambda-execution-role-arn VpcSubnetIds: Type: AWS::SSM::Parameter::Value&lt;List&lt;String&gt;&gt; Default: /shared/vpc/private-subnet-ids VpcSecurityGroupId: Type: AWS::SSM::Parameter::Value&lt;String&gt; Default: /shared/vpc/lambda-security-group-id DataBucketName: Type: AWS::SSM::Parameter::Value&lt;String&gt; Default: /shared/s3/data-bucket-nameGlobals: Function: Runtime: python3.11 Timeout: 30 MemorySize: 512 Role: !Ref LambdaExecutionRoleArn VpcConfig: SubnetIds: !Ref VpcSubnetIds SecurityGroupIds: - !Ref VpcSecurityGroupIdResources: # Layerå®šç¾© DependenciesLayer: Type: AWS::Serverless::LayerVersion Properties: LayerName: common-dependencies ContentUri: layers/dependencies/ CompatibleRuntimes: - python3.11 Metadata: BuildMethod: python3.11 CompanyUtilsLayer: Type: AWS::Serverless::LayerVersion Properties: LayerName: company-utils ContentUri: layers/company-utils/ CompatibleRuntimes: - python3.11 # Lambdaé–¢æ•° UserLoginFunction: Type: AWS::Serverless::Function Properties: FunctionName: user-login-function CodeUri: functions/auth/login/ Handler: app.handler Layers: - !Ref DependenciesLayer - !Ref CompanyUtilsLayer Environment: Variables: DATA_BUCKET: !Ref DataBucketName LOG_LEVEL: INFO # stagingã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆè‡ªå‹•æ›´æ–°ï¼‰ UserLoginStagingAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: !GetAtt UserLoginFunctionVersion.Version Name: staging UserLoginFunctionVersion: Type: AWS::Lambda::Version Properties: FunctionName: !Ref UserLoginFunction # productionã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆå®šç¾©ã®ã¿ã€æ›´æ–°ã¯æ‰‹å‹•ï¼‰ UserLoginProductionAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: &quot;1&quot; # åˆæœŸå€¤ Name: production DeletionPolicy: Retain GitHub Actionsï¼ˆCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰Terraformãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼123456789101112131415161718192021222324252627282930313233# terraform-infrastructure/.github/workflows/terraform-apply.ymlname: Terraform Applyon: push: branches: [main] paths: - 'terraform/**' - 'environments/**' - 'modules/**'jobs: terraform: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - uses: hashicorp/setup-terraform@v3 - uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: ${{ secrets.AWS_TERRAFORM_ROLE }} aws-region: ap-northeast-1 - name: Terraform Init run: terraform init - name: Terraform Plan run: terraform plan -out=tfplan - name: Terraform Apply run: terraform apply tfplan SAMãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# lambda-applications/.github/workflows/deploy-staging.ymlname: Deploy to Stagingon: push: branches: [main] paths: - 'functions/**' - 'layers/**' - 'template.yaml'jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - uses: aws-actions/setup-sam@v2 - uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: ${{ secrets.AWS_LAMBDA_ROLE }} aws-region: ap-northeast-1 - name: SAM Build run: sam build --use-container - name: SAM Deploy run: sam deploy --no-confirm-changeset --no-fail-on-empty-changeset - name: Publish Version id: version run: | VERSION=$(aws lambda publish-version \\ --function-name user-login-function \\ --description &quot;Commit: ${{ github.sha }}&quot; \\ --query 'Version' \\ --output text) echo &quot;version=$VERSION&quot; &gt;&gt; $GITHUB_OUTPUT - name: Save Version to SSM run: | aws ssm put-parameter \\ --name &quot;/apps/user-login-function/latest-version&quot; \\ --value &quot;${{ steps.version.outputs.version }}&quot; \\ --type String \\ --overwrite ãƒªã‚½ãƒ¼ã‚¹é…ç½®ã®ãƒ«ãƒ¼ãƒ«åˆ¤æ–­ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ã®é…ç½®ã‚’æ±ºã‚ã‚‹: Q1: ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¯ï¼Ÿâ”œâ”€ é »ç¹ã«å¤‰æ›´ï¼ˆé€±1å›ä»¥ä¸Šï¼‰ â†’ Q2ã¸â””â”€ ç¨€ï¼ˆæœˆ1å›ä»¥ä¸‹ï¼‰ â†’ Terraform Q2: å…±æœ‰åº¦ã¯ï¼Ÿâ”œâ”€ è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ â†’ Terraformâ””â”€ Lambdaå°‚ç”¨ â†’ SAM Q3: ãƒªã‚½ãƒ¼ã‚¹ã®æ€§è³ªã¯ï¼Ÿâ”œâ”€ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/èªè¨¼ â†’ Terraformâ”œâ”€ ç›£è¦–/ãƒ­ã‚°åŸºç›¤ â†’ Terraformâ””â”€ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ â†’ SAM ãƒªã‚½ãƒ¼ã‚¹é…ç½®ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ ãƒªã‚½ãƒ¼ã‚¹ é…ç½® ç†ç”± IAMãƒ­ãƒ¼ãƒ« Terraform ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€å…±æœ‰ VPC/Subnet/SG Terraform ã‚¤ãƒ³ãƒ•ãƒ©åŸºç›¤ RDS/DynamoDB(å…±æœ‰) Terraform è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ S3(å…±æœ‰) Terraform è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ Secrets Manager Terraform ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ EventBridge Pipes Terraform å…±æœ‰ã€ç›£è¦–é‡è¦ SQS/SNS(å…±æœ‰) Terraform è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ Lambdaé–¢æ•° SAM é »ç¹ã«å¤‰æ›´ Lambda Layer SAM é »ç¹ã«å¤‰æ›´ SQS/SNS(å°‚ç”¨) SAM é–¢æ•°ã¨å¯†çµåˆ EventBridge(å°‚ç”¨) SAM é–¢æ•°ã¨å¯†çµåˆ DynamoDB(å°‚ç”¨å°è¦æ¨¡) SAM é–¢æ•°å°‚ç”¨ å…·ä½“ä¾‹ã‚±ãƒ¼ã‚¹1: SQS123456789101112# å…±æœ‰ã‚­ãƒ¥ãƒ¼ï¼ˆè¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ãŒä½¿ç”¨ï¼‰ â†’ Terraformresource &quot;aws_sqs_queue&quot; &quot;order_processing&quot; { name = &quot;order-processing-queue&quot; # Lambdaã€APIã€ãƒãƒƒãƒå‡¦ç†ãŒä½¿ç”¨}# å°‚ç”¨ã‚­ãƒ¥ãƒ¼ï¼ˆç‰¹å®šé–¢æ•°ã®ã¿ã€è¨­å®šã‚’é »ç¹ã«èª¿æ•´ï¼‰ â†’ SAMResources: ImageProcessingQueue: Type: AWS::SQS::Queue Properties: VisibilityTimeout: 300 # é »ç¹ã«èª¿æ•´ ã‚±ãƒ¼ã‚¹2: EventBridge1234567891011121314# EventBridge Pipesï¼ˆè¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹æ¥ç¶šï¼‰ â†’ Terraformresource &quot;aws_pipes_pipe&quot; &quot;stream_processor&quot; { source = aws_dynamodb_table.orders.stream_arn target = aws_sqs_queue.processing.arn}# EventBridge Ruleï¼ˆç‰¹å®šé–¢æ•°å°‚ç”¨ï¼‰ â†’ SAMResources: DailyReportSchedule: Type: AWS::Events::Rule Properties: ScheduleExpression: cron(0 9 * * ? *) Targets: - Arn: !GetAtt ReportFunction.Arn ã‚±ãƒ¼ã‚¹3: Lambdaé–¢æ•°ã®åˆ†é¡1234567891011# ã‚¤ãƒ³ãƒ•ãƒ©ç³»Lambdaï¼ˆèªè¨¼ã€ç›£è¦–ï¼‰ â†’ Terraformresource &quot;aws_lambda_function&quot; &quot;api_authorizer&quot; { function_name = &quot;api-gateway-authorizer&quot; # å…¨APIã§ä½¿ç”¨ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦}# ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯Lambda â†’ SAMResources: OrderProcessingFunction: Type: AWS::Serverless::Function # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€é »ç¹ã«å¤‰æ›´ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç†æˆ¦ç•¥ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®å½¹å‰²ã‚¨ã‚¤ãƒªã‚¢ã‚¹ = Lambdaé–¢æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®ãƒã‚¤ãƒ³ã‚¿ ç›®çš„: ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢ ç’°å¢ƒã®è­˜åˆ¥ï¼ˆdevelopmentã€stagingã€productionï¼‰ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ¶å¾¡ï¼ˆã‚«ãƒŠãƒªã‚¢ã€ãƒ–ãƒ«ãƒ¼ã‚°ãƒªãƒ¼ãƒ³ï¼‰ ç¬æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ§‹æˆ123456789101112131415Lambdaé–¢æ•°: user-login-functionâ”‚â”œâ”€â”€ Versionsï¼ˆä¸å¤‰ï¼‰â”‚ â”œâ”€â”€ $LATESTï¼ˆæœ€æ–°ã‚³ãƒ¼ãƒ‰ï¼‰â”‚ â”œâ”€â”€ Version 1â”‚ â”œâ”€â”€ Version 2â”‚ â”œâ”€â”€ ...â”‚ â”œâ”€â”€ Version 14â”‚ â”œâ”€â”€ Version 15ï¼ˆç¾åœ¨ã®æœ¬ç•ªï¼‰â”‚ â””â”€â”€ Version 16ï¼ˆæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰â”‚â””â”€â”€ Aliasesï¼ˆãƒã‚¤ãƒ³ã‚¿ï¼‰ â”œâ”€â”€ development â†’ $LATEST â”œâ”€â”€ staging â†’ Version 16 â””â”€â”€ production â†’ Version 15 ç’°å¢ƒåˆ¥ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹æˆ¦ç•¥Developmentç›®çš„: é–‹ç™ºè€…ã®å‹•ä½œç¢ºèª è¨­å®š: ã‚¨ã‚¤ãƒªã‚¢ã‚¹: development ãƒãƒ¼ã‚¸ãƒ§ãƒ³: $LATESTï¼ˆå¸¸ã«æœ€æ–°ï¼‰ æ›´æ–°: è‡ªå‹•ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ï¼‰ ç‰¹å¾´: æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å³åº§ã«åæ˜  ä¸å®‰å®šã§ã‚‚å•é¡Œãªã„ ãƒ‡ãƒãƒƒã‚°ç’°å¢ƒ Stagingç›®çš„: QAã€çµ±åˆãƒ†ã‚¹ãƒˆ è¨­å®š: ã‚¨ã‚¤ãƒªã‚¢ã‚¹: staging ãƒãƒ¼ã‚¸ãƒ§ãƒ³: æœ€æ–°ç™ºè¡Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ æ›´æ–°: è‡ªå‹•ï¼ˆCI/CDï¼‰ ãƒ•ãƒ­ãƒ¼: mainãƒ–ãƒ©ãƒ³ãƒã«merge SAM build &amp; deploy Versionã‚’ç™ºè¡Œ stagingã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è‡ªå‹•æ›´æ–° ç‰¹å¾´: æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å‰ã®æœ€çµ‚ç¢ºèª å®‰å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ æœ¬ç•ªç’°å¢ƒã«è¿‘ã„è¨­å®š Productionç›®çš„: ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ è¨­å®š: ã‚¨ã‚¤ãƒªã‚¢ã‚¹: production ãƒãƒ¼ã‚¸ãƒ§ãƒ³: æ‰¿èªã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ æ›´æ–°: æ‰‹å‹•ï¼ˆæ‰¿èªå¾Œï¼‰ ãƒ•ãƒ­ãƒ¼: staging ã§æ¤œè¨¼å®Œäº† ãƒªãƒªãƒ¼ã‚¹ç”³è«‹ï¼ˆSlackç­‰ï¼‰ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ æ‰¿èª ãƒªãƒªãƒ¼ã‚¹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ productionã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ›´æ–° ç‰¹å¾´: æœ€ã‚‚æ…é‡ãªç®¡ç† æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹å¿…é ˆ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æº–å‚™ ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ›´æ–°ã®å®Ÿè£…SAMå´ï¼ˆstagingè‡ªå‹•æ›´æ–°ï¼‰12345678910111213141516171819202122232425262728# template.yamlResources: UserLoginFunction: Type: AWS::Serverless::Function # ... # stagingã¯è‡ªå‹•æ›´æ–° StagingAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: !GetAtt LatestVersion.Version Name: staging LatestVersion: Type: AWS::Lambda::Version Properties: FunctionName: !Ref UserLoginFunction Description: !Sub &quot;Deployed: ${AWS::StackName}&quot; # productionã¯å®šç¾©ã®ã¿ ProductionAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: &quot;1&quot; # åˆæœŸå€¤ Name: production DeletionPolicy: Retain æ‰‹å‹•ãƒªãƒªãƒ¼ã‚¹ï¼ˆproductionæ›´æ–°ï¼‰12345678910111213141516171819202122232425262728293031323334353637383940# .github/workflows/release-production.ymlname: Release to Productionon: workflow_dispatch: inputs: function_name: description: 'Function name' required: true version: description: 'Version to release' required: truejobs: release: runs-on: ubuntu-latest steps: - name: Update Production Alias run: | aws lambda update-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --function-version ${{ inputs.version }} - name: Verify run: | # ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãŒæ­£ã—ãæ›´æ–°ã•ã‚ŒãŸã‹ç¢ºèª CURRENT_VERSION=$(aws lambda get-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --query 'FunctionVersion' \\ --output text) if [ &quot;$CURRENT_VERSION&quot; == &quot;${{ inputs.version }}&quot; ]; then echo &quot;âœ… Successfully released version ${{ inputs.version }}&quot; else echo &quot;âŒ Release failed&quot; exit 1 fi é€£æºãƒ¡ã‚«ãƒ‹ã‚ºãƒ SSM Parameter Store ã«ã‚ˆã‚‹é€£æºãƒ•ãƒ­ãƒ¼: TerraformãŒãƒªã‚½ãƒ¼ã‚¹ä½œæˆâ””â”€ IAMãƒ­ãƒ¼ãƒ«ã€VPCã€RDSç­‰ TerraformãŒSSMã«å€¤ã‚’å‡ºåŠ›â””â”€ /shared/* ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ SAMãŒSSMã‹ã‚‰å€¤ã‚’å–å¾—â””â”€ Parameters ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å‚ç…§ Lambdaé–¢æ•°ãŒè¨­å®šã•ã‚Œã‚‹â””â”€ æ­£ã—ã„ãƒ­ãƒ¼ãƒ«ã€VPCã€æ¥ç¶šæƒ…å ± å…·ä½“ä¾‹Terraformå´1234567891011121314151617# IAMãƒ­ãƒ¼ãƒ«ä½œæˆresource &quot;aws_iam_role&quot; &quot;lambda_execution&quot; { name = &quot;lambda-execution-role&quot; # ...}# SSMã«å‡ºåŠ›resource &quot;aws_ssm_parameter&quot; &quot;lambda_role_arn&quot; { name = &quot;/shared/iam/lambda-execution-role-arn&quot; type = &quot;String&quot; value = aws_iam_role.lambda_execution.arn tags = { ManagedBy = &quot;Terraform&quot; Description = &quot;Lambda execution role ARN for SAM&quot; }} SAMå´123456789101112# SSMã‹ã‚‰å–å¾—Parameters: LambdaRoleArn: Type: AWS::SSM::Parameter::Value&lt;String&gt; Default: /shared/iam/lambda-execution-role-arn# Lambdaé–¢æ•°ã§ä½¿ç”¨Resources: MyFunction: Type: AWS::Serverless::Function Properties: Role: !Ref LambdaRoleArn # SSMã‹ã‚‰å–å¾—ã—ãŸå€¤ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®å…±æœ‰ãƒ•ãƒ­ãƒ¼: SAMãŒLambdaã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç™ºè¡Œ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’SSMã«ä¿å­˜â””â”€ /apps/{function-name}/latest-version ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ãŒå‚ç…§ æ‰¿èªå¾Œã€ãƒªãƒªãƒ¼ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½¿ç”¨ å®Ÿè£…123456789101112131415161718192021# SAM ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ- name: Save Version Info run: | VERSION=${{ steps.version.outputs.version }} # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå· aws ssm put-parameter \\ --name &quot;/apps/${{ inputs.function_name }}/latest-version&quot; \\ --value &quot;$VERSION&quot; \\ --overwrite # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ aws ssm put-parameter \\ --name &quot;/apps/${{ inputs.function_name }}/version-$VERSION/metadata&quot; \\ --value '{ &quot;version&quot;: &quot;'$VERSION'&quot;, &quot;commit&quot;: &quot;${{ github.sha }}&quot;, &quot;deployed_at&quot;: &quot;'$(date -u +%Y-%m-%dT%H:%M:%SZ)'&quot;, &quot;deployed_by&quot;: &quot;${{ github.actor }}&quot; }' \\ --overwrite ã¾ã¨ã‚æ§‹æˆè¦ç´ ã®å½¹å‰²Terraform:âœ“ ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£âœ“ IAMã€VPCã€ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢âœ“ å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹âœ“ å®‰å®šã—ãŸè¨­å®š SAM:âœ“ Lambdaé–¢æ•°ã¨Layerâœ“ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯âœ“ é »ç¹ã«å¤‰æ›´ã™ã‚‹ã‚‚ã®âœ“ Lambdaå°‚ç”¨ãƒªã‚½ãƒ¼ã‚¹ GitHub Actions:âœ“ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³âœ“ è‡ªå‹•åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼âœ“ æ‰¿èªãƒ•ãƒ­ãƒ¼ SSM Parameter Store:âœ“ è¨­å®šå€¤ã®å…±æœ‰âœ“ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ä¿å­˜âœ“ Terraform â†” SAM é€£æº é€£æºã®è¦ç‚¹ SSM Parameter StoreãŒæ©‹æ¸¡ã— stagingã¯è‡ªå‹•ã€productionã¯æ‰‹å‹• ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å…±æœ‰ æ˜ç¢ºãªè²¬ä»»ç¯„å›² æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—æ§‹æˆè¦ç´ ã‚’ç†è§£ã—ãŸã‚‰ã€å®Ÿè£…ã®è©³ç´°ã«é€²ã¿ã¾ã™ã€‚ ğŸ‘‰ æ¬¡ã¸: 3. å„æ§‹æˆè¦ç´ ã®å®Ÿè£…ã«é–¢ã™ã‚‹ç•™æ„ç‚¹","link":"/2025/11/02/lambda-cicd-02-components/"},{"title":"Lambda CI&#x2F;CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - 3. å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³","text":"ç›®æ¬¡ Terraformå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ SAMå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ GitHub Actionså®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ å‘½åè¦å‰‡ã¨ã‚¿ã‚°æˆ¦ç•¥ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é … ç›£è¦–ã¨ãƒ­ã‚®ãƒ³ã‚° Terraformå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ IAMãƒ­ãƒ¼ãƒ«ãƒ»ãƒãƒªã‚·ãƒ¼ç®¡ç†åŸºæœ¬æ–¹é‡åŸå‰‡:âœ“ æœ€å°æ¨©é™ã®åŸå‰‡ï¼ˆPrinciple of Least Privilegeï¼‰âœ“ ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆRBACï¼‰âœ“ ãƒãƒªã‚·ãƒ¼ã®å†åˆ©ç”¨æ€§âœ“ æ˜ç¤ºçš„ãªæ¨©é™ä»˜ä¸ Lambdaå®Ÿè¡Œãƒ­ãƒ¼ãƒ«ã®å®Ÿè£…12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697# terraform-infrastructure/iam/lambda-roles.tf# åŸºæœ¬çš„ãªå®Ÿè¡Œãƒ­ãƒ¼ãƒ«resource &quot;aws_iam_role&quot; &quot;lambda_execution&quot; { name = &quot;lambda-execution-role&quot; description = &quot;Basic execution role for Lambda functions&quot; assume_role_policy = jsonencode({ Version = &quot;2012-10-17&quot; Statement = [{ Action = &quot;sts:AssumeRole&quot; Effect = &quot;Allow&quot; Principal = { Service = &quot;lambda.amazonaws.com&quot; } }] }) tags = { ManagedBy = &quot;Terraform&quot; Purpose = &quot;LambdaExecution&quot; Environment = var.environment }}# åŸºæœ¬çš„ãªãƒ­ã‚®ãƒ³ã‚°æ¨©é™resource &quot;aws_iam_role_policy_attachment&quot; &quot;lambda_basic_execution&quot; { role = aws_iam_role.lambda_execution.name policy_arn = &quot;arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole&quot;}# VPCå†…å®Ÿè¡Œã®æ¨©é™resource &quot;aws_iam_role_policy_attachment&quot; &quot;lambda_vpc_execution&quot; { role = aws_iam_role.lambda_execution.name policy_arn = &quot;arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole&quot;}# ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªã‚·ãƒ¼ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®æ¨©é™ï¼‰resource &quot;aws_iam_role_policy&quot; &quot;lambda_application_policy&quot; { name = &quot;lambda-application-policy&quot; role = aws_iam_role.lambda_execution.id policy = jsonencode({ Version = &quot;2012-10-17&quot; Statement = [ # S3ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç‰¹å®šã®ãƒã‚±ãƒƒãƒˆã®ã¿ï¼‰ { Sid = &quot;S3Access&quot; Effect = &quot;Allow&quot; Action = [ &quot;s3:GetObject&quot;, &quot;s3:PutObject&quot; ] Resource = [ &quot;${aws_s3_bucket.data.arn}/*&quot; ] }, # DynamoDBã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç‰¹å®šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿ï¼‰ { Sid = &quot;DynamoDBAccess&quot; Effect = &quot;Allow&quot; Action = [ &quot;dynamodb:GetItem&quot;, &quot;dynamodb:PutItem&quot;, &quot;dynamodb:Query&quot;, &quot;dynamodb:UpdateItem&quot; ] Resource = [ aws_dynamodb_table.orders.arn, &quot;${aws_dynamodb_table.orders.arn}/index/*&quot; ] }, # Secrets Managerã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç‰¹å®šã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ã¿ï¼‰ { Sid = &quot;SecretsManagerAccess&quot; Effect = &quot;Allow&quot; Action = [ &quot;secretsmanager:GetSecretValue&quot; ] Resource = [ aws_secretsmanager_secret.api_keys.arn ] }, # SQSé€ä¿¡ï¼ˆç‰¹å®šã®ã‚­ãƒ¥ãƒ¼ã®ã¿ï¼‰ { Sid = &quot;SQSSendMessage&quot; Effect = &quot;Allow&quot; Action = [ &quot;sqs:SendMessage&quot; ] Resource = [ aws_sqs_queue.notifications.arn ] } ] })} ç•™æ„ç‚¹é‡è¦ãªè€ƒæ…®äº‹é …: æ¨©é™ã®ç´°åˆ†åŒ–:å•é¡Œ: å…¨ã¦ã®S3ãƒã‚±ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯è§£æ±º: ç‰¹å®šã®ãƒã‚±ãƒƒãƒˆãƒ»ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã«é™å®š æ‚ªã„ä¾‹: Resource = â€œarn:aws:s3:::*â€ è‰¯ã„ä¾‹: Resource = [â€œ${aws_s3_bucket.data.arn}/uploads/â€œ,â€œ${aws_s3_bucket.data.arn}/processed/â€œ ] æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹:æ¨å¥¨: æ¡ä»¶ã‚’ä½¿ã£ã¦æ›´ã«åˆ¶é™ ä¾‹: VPCå†…ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½Condition = { StringEquals = {â€œaws:SourceVpcâ€ = aws_vpc.main.id }} ãƒãƒªã‚·ãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†: å¤‰æ›´æ™‚ã¯å¿…ãšPull Request ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯è¤‡æ•°äººã§å®Ÿæ–½ æœ¬ç•ªé©ç”¨å‰ã«stagingã§æ¤œè¨¼ å®šæœŸçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼: å››åŠæœŸã”ã¨ã«æ¨©é™ã‚’è¦‹ç›´ã— ä¸è¦ãªæ¨©é™ã¯å‰Šé™¤ AWS Access Analyzerã‚’æ´»ç”¨ VPCãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šåŸºæœ¬æ§‹æˆ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100# terraform-infrastructure/vpc/main.tf# VPCresource &quot;aws_vpc&quot; &quot;main&quot; { cidr_block = var.vpc_cidr enable_dns_hostnames = true enable_dns_support = true tags = { Name = &quot;${var.project_name}-vpc&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }}# ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆï¼ˆLambdaç”¨ï¼‰resource &quot;aws_subnet&quot; &quot;private&quot; { count = length(var.availability_zones) vpc_id = aws_vpc.main.id cidr_block = cidrsubnet(var.vpc_cidr, 4, count.index) availability_zone = var.availability_zones[count.index] tags = { Name = &quot;${var.project_name}-private-${count.index + 1}&quot; Type = &quot;Private&quot; Purpose = &quot;Lambda&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }}# Lambdaç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—resource &quot;aws_security_group&quot; &quot;lambda&quot; { name = &quot;${var.project_name}-lambda-sg&quot; description = &quot;Security group for Lambda functions&quot; vpc_id = aws_vpc.main.id # ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã¯å…¨ã¦è¨±å¯ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã€RDSç­‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼‰ egress { from_port = 0 to_port = 0 protocol = &quot;-1&quot; cidr_blocks = [&quot;0.0.0.0/0&quot;] description = &quot;Allow all outbound traffic&quot; } tags = { Name = &quot;${var.project_name}-lambda-sg&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }}# RDSç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—resource &quot;aws_security_group&quot; &quot;rds&quot; { name = &quot;${var.project_name}-rds-sg&quot; description = &quot;Security group for RDS&quot; vpc_id = aws_vpc.main.id # Lambdaã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã®ã¿è¨±å¯ ingress { from_port = 5432 # PostgreSQL to_port = 5432 protocol = &quot;tcp&quot; security_groups = [aws_security_group.lambda.id] description = &quot;Allow Lambda functions to access RDS&quot; } tags = { Name = &quot;${var.project_name}-rds-sg&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }}# NAT Gatewayï¼ˆLambdaãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆï¼‰resource &quot;aws_eip&quot; &quot;nat&quot; { count = var.enable_nat_gateway ? length(var.availability_zones) : 0 domain = &quot;vpc&quot; tags = { Name = &quot;${var.project_name}-nat-eip-${count.index + 1}&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }}resource &quot;aws_nat_gateway&quot; &quot;main&quot; { count = var.enable_nat_gateway ? length(var.availability_zones) : 0 allocation_id = aws_eip.nat[count.index].id subnet_id = aws_subnet.public[count.index].id tags = { Name = &quot;${var.project_name}-nat-${count.index + 1}&quot; ManagedBy = &quot;Terraform&quot; Environment = var.environment }} ç•™æ„ç‚¹VPCè¨­å®šã®æ³¨æ„ç‚¹: ã‚µãƒ–ãƒãƒƒãƒˆè¨­è¨ˆ: Lambdaç”¨ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã‚’ç”¨æ„ æœ€ä½2ã¤ã®AZï¼ˆå¯ç”¨æ€§ç¢ºä¿ï¼‰ CIDRç¯„å›²ã¯å°†æ¥ã®æ‹¡å¼µã‚’è€ƒæ…® NAT Gateway:ã‚³ã‚¹ãƒˆè€ƒæ…®: development: NAT Gateway ãªã—ï¼ˆVPCå¤–ã‚¢ã‚¯ã‚»ã‚¹ä¸è¦ï¼‰ staging: 1ã¤ã®NAT Gateway production: AZã”ã¨ã«NAT Gatewayï¼ˆé«˜å¯ç”¨æ€§ï¼‰ æ³¨æ„: NAT Gatewayã¯å¾“é‡èª²é‡‘ï¼ˆ$0.045/hour + ãƒ‡ãƒ¼ã‚¿è»¢é€è²»ï¼‰ æœ¬å½“ã«å¿…è¦ã‹æ¤œè¨ï¼ˆVPC Endpointã§ä»£æ›¿å¯èƒ½ãªå ´åˆã‚‚ï¼‰ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—: Lambdaã‹ã‚‰ã®ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã¯å¿…è¦æœ€å°é™ã« ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ«ãƒ¼ãƒ«ã¯ä¸è¦ï¼ˆLambdaã¯å—ä¿¡ã—ãªã„ï¼‰ å‘½åè¦å‰‡ã‚’çµ±ä¸€ VPC Endpoint:æ¨å¥¨: S3ã€DynamoDBç­‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«VPC Endpointã‚’ä½¿ç”¨ãƒ¡ãƒªãƒƒãƒˆ: NAT Gatewayä¸è¦ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰ ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ”¹å–„ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š ä¾‹:resource â€œaws_vpc_endpointâ€ â€œs3â€ { vpc_id = aws_vpc.main.id service_name = â€œcom.amazonaws.ap-northeast-1.s3â€} DNSè¨­å®š: enable_dns_hostnames = trueï¼ˆRDSç­‰ã®æ¥ç¶šã«å¿…è¦ï¼‰ enable_dns_support = true SSM Parameter Storeæ´»ç”¨å‘½åè¦å‰‡123456789101112131415161718192021222324# çµ±ä¸€ã•ã‚ŒãŸå‘½åè¦å‰‡# å…±æœ‰å€¤ï¼ˆTerraform â†’ SAMï¼‰/shared/{service}/{resource-type}/{name}ä¾‹:/shared/iam/lambda-execution-role-arn/shared/vpc/private-subnet-ids/shared/vpc/lambda-security-group-id/shared/rds/endpoint/shared/rds/port/shared/rds/database-name/shared/s3/data-bucket-name/shared/dynamodb/orders-table-name/shared/sqs/notification-queue-url/shared/sns/alerts-topic-arn# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æƒ…å ±ï¼ˆSAM â†’ Terraformï¼‰/apps/{function-name}/{key}ä¾‹:/apps/user-login-function/latest-version/apps/user-login-function/version-15/metadata/apps/user-login-function/deployed-at å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# terraform-infrastructure/shared-values/main.tflocals { shared_parameters = { # IAM &quot;iam/lambda-execution-role-arn&quot; = aws_iam_role.lambda_execution.arn # VPC &quot;vpc/vpc-id&quot; = aws_vpc.main.id &quot;vpc/private-subnet-ids&quot; = join(&quot;,&quot;, aws_subnet.private[*].id) &quot;vpc/lambda-security-group-id&quot; = aws_security_group.lambda.id # RDS &quot;rds/endpoint&quot; = aws_db_instance.main.endpoint &quot;rds/port&quot; = aws_db_instance.main.port &quot;rds/database-name&quot; = aws_db_instance.main.db_name # S3 &quot;s3/data-bucket-name&quot; = aws_s3_bucket.data.id &quot;s3/uploads-bucket-name&quot; = aws_s3_bucket.uploads.id # DynamoDB &quot;dynamodb/orders-table-name&quot; = aws_dynamodb_table.orders.name &quot;dynamodb/sessions-table-name&quot; = aws_dynamodb_table.sessions.name # SQS &quot;sqs/notification-queue-url&quot; = aws_sqs_queue.notifications.url &quot;sqs/dlq-queue-url&quot; = aws_sqs_queue.dlq.url # SNS &quot;sns/alerts-topic-arn&quot; = aws_sns_topic.alerts.arn }}# ä¸€æ‹¬ä½œæˆresource &quot;aws_ssm_parameter&quot; &quot;shared&quot; { for_each = local.shared_parameters name = &quot;/shared/${each.key}&quot; type = each.key == &quot;vpc/private-subnet-ids&quot; ? &quot;StringList&quot; : &quot;String&quot; value = each.value tags = { ManagedBy = &quot;Terraform&quot; Purpose = &quot;SharedConfiguration&quot; Environment = var.environment }} ç•™æ„ç‚¹SSM Parameter Storeä½¿ç”¨æ™‚ã®æ³¨æ„: ã‚¿ã‚¤ãƒ—ã®é¸æŠ: String: å˜ä¸€ã®å€¤ StringList: ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®ãƒªã‚¹ãƒˆï¼ˆã‚µãƒ–ãƒãƒƒãƒˆIDç­‰ï¼‰ SecureString: æš—å·åŒ–ãŒå¿…è¦ãªå€¤ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç­‰ï¼‰ æ›´æ–°ã®è€ƒæ…®: â€“overwrite ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ä¸Šæ›¸ãå¯èƒ½ å¤ã„å€¤ã¯å±¥æ­´ã¨ã—ã¦ä¿æŒã•ã‚Œãªã„ï¼ˆæ³¨æ„ï¼‰ é‡è¦ãªå€¤ã¯åˆ¥é€”ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: SAMãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«æ¯å›å–å¾— ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œãªã„ å¤§é‡ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯é¿ã‘ã‚‹ï¼ˆå¿…è¦æœ€å°é™ï¼‰ ã‚³ã‚¹ãƒˆ: Standard tier: 10,000ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¾ã§ç„¡æ–™ Advanced tier: $0.05/ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿/æœˆ é€šå¸¸ã¯Standardã§ååˆ† ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡: IAMãƒãƒªã‚·ãƒ¼ã§åˆ¶å¾¡ æœ€å°æ¨©é™ã®åŸå‰‡ ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã®åˆ¶å¾¡ã‚‚å¯èƒ½ SAMå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³Lambdaé–¢æ•°æ§‹æˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 1234567891011121314151617functions/â”œâ”€â”€ auth/â”‚ â”œâ”€â”€ login/â”‚ â”‚ â”œâ”€â”€ app.py # ãƒ¡ã‚¤ãƒ³ãƒãƒ³ãƒ‰ãƒ©â”‚ â”‚ â”œâ”€â”€ requirements.txt # ä¾å­˜é–¢ä¿‚â”‚ â”‚ â”œâ”€â”€ config.py # è¨­å®šâ”‚ â”‚ â”œâ”€â”€ validators.py # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³â”‚ â”‚ â””â”€â”€ tests/â”‚ â”‚ â”œâ”€â”€ test_app.pyâ”‚ â”‚ â””â”€â”€ test_validators.pyâ”‚ â”‚â”‚ â”œâ”€â”€ logout/â”‚ â””â”€â”€ refresh-token/â”‚â””â”€â”€ orders/ â”œâ”€â”€ create-order/ â””â”€â”€ list-orders/ é–¢æ•°å®Ÿè£…ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109# functions/auth/login/app.pyimport jsonimport osfrom typing import Dict, Anyfrom company.logger import get_logger # Layerã‹ã‚‰from company.auth import verify_credentials # Layerã‹ã‚‰# ãƒ­ã‚¬ãƒ¼ã®åˆæœŸåŒ–ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰logger = get_logger(__name__)# ç’°å¢ƒå¤‰æ•°ã®å–å¾—ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰DB_ENDPOINT = os.environ['DB_ENDPOINT']TABLE_NAME = os.environ['TABLE_NAME']# æ¥ç¶šã®åˆæœŸåŒ–ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã€å†åˆ©ç”¨ï¼‰import boto3dynamodb = boto3.resource('dynamodb')table = dynamodb.Table(TABLE_NAME)def lambda_handler(event: Dict[str, Any], context: Any) -&gt; Dict[str, Any]: &quot;&quot;&quot; Lambdaé–¢æ•°ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ Args: event: API Gatewayã‚¤ãƒ™ãƒ³ãƒˆ context: Lambdaã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ Returns: API Gatewayãƒ¬ã‚¹ãƒãƒ³ã‚¹ &quot;&quot;&quot; try: # ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ­ã‚° logger.info(&quot;Login attempt&quot;, extra={ &quot;request_id&quot;: context.request_id, &quot;source_ip&quot;: event.get('requestContext', {}).get('identity', {}).get('sourceIp') }) # ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®è§£æ body = json.loads(event.get('body', '{}')) username = body.get('username') password = body.get('password') # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ if not username or not password: logger.warning(&quot;Missing credentials&quot;) return error_response(400, &quot;Username and password are required&quot;) # èªè¨¼å‡¦ç† if not verify_credentials(username, password): logger.warning(&quot;Invalid credentials&quot;, extra={&quot;username&quot;: username}) return error_response(401, &quot;Invalid credentials&quot;) # ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ session_token = create_session(username) logger.info(&quot;Login successful&quot;, extra={&quot;username&quot;: username}) return { 'statusCode': 200, 'headers': { 'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*' }, 'body': json.dumps({ 'token': session_token, 'username': username }) } except Exception as e: logger.error(&quot;Login failed&quot;, extra={ &quot;error&quot;: str(e), &quot;request_id&quot;: context.request_id }, exc_info=True) return error_response(500, &quot;Internal server error&quot;)def error_response(status_code: int, message: str) -&gt; Dict[str, Any]: &quot;&quot;&quot;ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆ&quot;&quot;&quot; return { 'statusCode': status_code, 'headers': { 'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*' }, 'body': json.dumps({'error': message}) }def create_session(username: str) -&gt; str: &quot;&quot;&quot;ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ&quot;&quot;&quot; import uuid from datetime import datetime, timedelta session_token = str(uuid.uuid4()) expiry = datetime.utcnow() + timedelta(hours=24) table.put_item( Item={ 'token': session_token, 'username': username, 'expiry': int(expiry.timestamp()) } ) return session_token ç•™æ„ç‚¹Lambdaé–¢æ•°å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ: ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®æ´»ç”¨:ç†ç”±: ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã®ã¿åˆæœŸåŒ–ã€ãã®å¾Œã¯å†åˆ©ç”¨ æ¨å¥¨: ãƒ­ã‚¬ãƒ¼ AWS SDKã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆboto3ç­‰ï¼‰ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š è¨­å®šå€¤ éæ¨å¥¨: ãƒªã‚¯ã‚¨ã‚¹ãƒˆå›ºæœ‰ã®ãƒ‡ãƒ¼ã‚¿ ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãªæƒ…å ± ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°:å¿…é ˆ: ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®try-except é©åˆ‡ãªãƒ­ã‚°å‡ºåŠ› ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ å†…éƒ¨ã‚¨ãƒ©ãƒ¼è©³ç´°ã¯éš è”½ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š:è€ƒæ…®äº‹é …: å‡¦ç†æ™‚é–“ + ãƒãƒ¼ã‚¸ãƒ³ é•·ã™ãã‚‹ã¨èª²é‡‘å¢—åŠ  çŸ­ã™ãã‚‹ã¨ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆé »ç™º æ¨å¥¨: è»½é‡API: 3-10ç§’ ãƒ‡ãƒ¼ã‚¿å‡¦ç†: 30-60ç§’ ãƒãƒƒãƒå‡¦ç†: 300-900ç§’ï¼ˆæœ€å¤§15åˆ†ï¼‰ ãƒ¡ãƒ¢ãƒªè¨­å®š:ãƒã‚¤ãƒ³ãƒˆ: ãƒ¡ãƒ¢ãƒªâ†‘ = CPUæ€§èƒ½â†‘ ã‚³ã‚¹ãƒˆã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒãƒ©ãƒ³ã‚¹ å®Ÿæ¸¬ã—ã¦æœ€é©åŒ– é–‹å§‹å€¤: è»½é‡API: 512MB ãƒ‡ãƒ¼ã‚¿å‡¦ç†: 1024MB é‡ã„å‡¦ç†: 2048MBä»¥ä¸Š ç’°å¢ƒå¤‰æ•°:ä½¿ã„åˆ†ã‘: ç’°å¢ƒã”ã¨ã«å¤‰ã‚ã‚‹å€¤: ç’°å¢ƒå¤‰æ•° æ©Ÿå¯†æƒ…å ±: Secrets Manager / SSM Parameter Store å›ºå®šå€¤: ã‚³ãƒ¼ãƒ‰ã«åŸ‹ã‚è¾¼ã¿ã‚‚å¯ Layerç®¡ç†Layeræ§‹é€ 12345678910111213141516171819layers/â”œâ”€â”€ dependencies/ # å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªâ”‚ â”œâ”€â”€ python/ # ãƒ©ãƒ³ã‚¿ã‚¤ãƒ åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªâ”‚ â”‚ â””â”€â”€ lib/â”‚ â”‚ â””â”€â”€ python3.11/â”‚ â”‚ â””â”€â”€ site-packages/â”‚ â”‚ â”œâ”€â”€ requests/â”‚ â”‚ â”œâ”€â”€ boto3/â”‚ â”‚ â””â”€â”€ ...â”‚ â””â”€â”€ requirements.txtâ”‚â””â”€â”€ company-utils/ # è‡ªç¤¾å…±é€šã‚³ãƒ¼ãƒ‰ â””â”€â”€ python/ â””â”€â”€ company/ â”œâ”€â”€ __init__.py â”œâ”€â”€ logger.py â”œâ”€â”€ auth.py â”œâ”€â”€ database.py â””â”€â”€ validators.py SAMãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ123456789101112131415161718192021222324252627# template.yamlResources: # ä¾å­˜é–¢ä¿‚Layerï¼ˆé »ç¹ã«æ›´æ–°ï¼‰ DependenciesLayer: Type: AWS::Serverless::LayerVersion Properties: LayerName: !Sub '${AWS::StackName}-dependencies' Description: External dependencies (requests, boto3, etc.) ContentUri: layers/dependencies/ CompatibleRuntimes: - python3.11 RetentionPolicy: Retain Metadata: BuildMethod: python3.11 # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£Layerï¼ˆå®‰å®šï¼‰ CompanyUtilsLayer: Type: AWS::Serverless::LayerVersion Properties: LayerName: company-utils Description: Company-wide utility functions ContentUri: layers/company-utils/ CompatibleRuntimes: - python3.11 - python3.10 RetentionPolicy: Retain ç•™æ„ç‚¹Layerç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹: Layeråˆ†å‰²æˆ¦ç•¥:æ¨å¥¨: å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªLayerï¼ˆé »ç¹ã«æ›´æ–°ï¼‰ è‡ªç¤¾å…±é€šã‚³ãƒ¼ãƒ‰Layerï¼ˆå®‰å®šï¼‰ ç†ç”±: å¤‰æ›´é »åº¦ãŒç•°ãªã‚‹ ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®æœ€é©åŒ– ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®æ˜ç¢ºåŒ– ã‚µã‚¤ã‚ºåˆ¶é™:åˆ¶ç´„: Layerå˜ä½“: 50MBï¼ˆåœ§ç¸®å¾Œï¼‰ å…¨Layeråˆè¨ˆ: 250MBï¼ˆå±•é–‹å¾Œï¼‰ å¯¾ç­–: ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«é™¤å¤–ï¼ˆtests/, docs/ï¼‰ å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« è¤‡æ•°Layerã«åˆ†å‰² ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†:é‡è¦: Layerã¯ä¸å¤‰ï¼ˆImmutableï¼‰ æ›´æ–°æ™‚ã¯æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½œæˆ é–¢æ•°ã¯ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‚ç…§ æ³¨æ„: å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä½¿ã‚ã‚Œãªããªã£ãŸã‚‰å‰Šé™¤ RetentionPolicy: Retain æ¨å¥¨ ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹:SAMã®è‡ªå‹•ãƒ“ãƒ«ãƒ‰: BuildMethodæŒ‡å®šã§è‡ªå‹•åŒ– requirements.txt ã‹ã‚‰è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è€ƒæ…®ï¼ˆx86_64 / arm64ï¼‰ ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹:ãƒã‚¤ãƒ³ãƒˆ: /opt/python ãŒPYTHONPATHã«è‡ªå‹•è¿½åŠ  from company.logger import â€¦ çµ¶å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ äº’æ›æ€§:ç¢ºèªäº‹é …: CompatibleRuntimes ã‚’æ˜ç¤º Pythonãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®äº’æ›æ€§ ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å ´åˆã¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®šå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# template.yamlResources: UserLoginFunction: Type: AWS::Serverless::Function Properties: FunctionName: user-login-function CodeUri: functions/auth/login/ Handler: app.lambda_handler # AutoPublishAliasã¯ä½¿ã‚ãªã„ # Developmentã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆ$LATESTï¼‰ UserLoginDevAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: $LATEST Name: development Description: Development environment - always latest code # Stagingã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆè‡ªå‹•æ›´æ–°ï¼‰ UserLoginStagingAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: !GetAtt UserLoginStagingVersion.Version Name: staging Description: !Sub &quot;Staging - Version ${UserLoginStagingVersion.Version}&quot; UserLoginStagingVersion: Type: AWS::Lambda::Version Properties: FunctionName: !Ref UserLoginFunction Description: !Sub | Deployed: ${AWS::StackName} Commit: ${GitCommitSha} Date: ${DeploymentDate} # Productionã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆæ‰‹å‹•æ›´æ–°ï¼‰ UserLoginProdAlias: Type: AWS::Lambda::Alias Properties: FunctionName: !Ref UserLoginFunction FunctionVersion: &quot;1&quot; # åˆæœŸå€¤ã€å¾Œã§æ‰‹å‹•æ›´æ–° Name: production Description: Production environment DeletionPolicy: Retain UpdateReplacePolicy: Retain ç•™æ„ç‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®šã®æ³¨æ„ç‚¹: AutoPublishAliasã‚’ä½¿ã‚ãªã„ç†ç”±:åˆ¶ç´„: ãƒ‡ãƒ—ãƒ­ã‚¤ = ãƒªãƒªãƒ¼ã‚¹ï¼ˆåˆ†é›¢ã§ããªã„ï¼‰ ç´°ã‹ã„åˆ¶å¾¡ãŒå›°é›£ è¤‡æ•°ç’°å¢ƒã®ç®¡ç†ãŒè¤‡é›‘ ä»£æ›¿: AWS::Lambda::Version ã§æ˜ç¤ºçš„ã«ç®¡ç† AWS::Lambda::Alias ã§ç’°å¢ƒã‚’åˆ†é›¢ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã®æ‰±ã„:æ³¨æ„: Versionãƒªã‚½ãƒ¼ã‚¹ã¯æ¯ãƒ‡ãƒ—ãƒ­ã‚¤ã§æ–°è¦ä½œæˆ è«–ç†IDãŒåŒã˜ã§ã‚‚ç‰©ç†çš„ã«ã¯åˆ¥ãƒãƒ¼ã‚¸ãƒ§ãƒ³ CloudFormationã‚¹ã‚¿ãƒƒã‚¯æ›´æ–°ã§è‡ªå‹•ç®¡ç† DeletionPolicy:æ¨å¥¨: production: Retainï¼ˆå‰Šé™¤ã—ãªã„ï¼‰ staging: Deleteï¼ˆå‰Šé™¤å¯èƒ½ï¼‰ ç†ç”±: æœ¬ç•ªã¯èª¤å‰Šé™¤é˜²æ­¢ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã«ä¿æŒ ã‚¨ã‚¤ãƒªã‚¢ã‚¹åã®çµ±ä¸€:è¦ç´„: developmentï¼ˆå°æ–‡å­—ï¼‰ stagingï¼ˆå°æ–‡å­—ï¼‰ productionï¼ˆå°æ–‡å­—ï¼‰ ç†ç”±: å…¨é–¢æ•°ã§çµ±ä¸€ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ‰±ã„ã‚„ã™ã„ ProvisionedConcurrency:è€ƒæ…®: ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå¯¾ç­– æœ¬ç•ªã®ã¿è¨­å®šï¼ˆã‚³ã‚¹ãƒˆé«˜ï¼‰ ä¾‹:UserLoginProdAlias: Properties: ProvisionedConcurrencyConfig: ProvisionedConcurrentExecutions: 5 GitHub Actionså®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼Stagingè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168# .github/workflows/deploy-staging.ymlname: Deploy to Stagingon: push: branches: - main paths: - 'functions/**' - 'layers/**' - 'template.yaml' - 'samconfig.toml'env: AWS_REGION: ap-northeast-1 ENVIRONMENT: stagingjobs: deploy: runs-on: ubuntu-latest # ç’°å¢ƒã®æŒ‡å®šï¼ˆæ‰¿èªä¸è¦ï¼‰ environment: name: staging url: https://staging.example.com steps: - name: Checkout code uses: actions/checkout@v4 with: fetch-depth: 0 # å…¨å±¥æ­´å–å¾—ï¼ˆgit diffç”¨ï¼‰ - name: Setup Python uses: actions/setup-python@v5 with: python-version: '3.11' - name: Setup SAM CLI uses: aws-actions/setup-sam@v2 with: version: latest - name: Configure AWS Credentials uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: ${{ secrets.AWS_LAMBDA_DEPLOY_ROLE }} role-session-name: GitHubActions-Staging aws-region: ${{ env.AWS_REGION }} - name: SAM Build run: | sam build \\ --use-container \\ --parallel - name: SAM Deploy run: | sam deploy \\ --no-confirm-changeset \\ --no-fail-on-empty-changeset \\ --stack-name lambda-app-staging \\ --capabilities CAPABILITY_IAM \\ --region ${{ env.AWS_REGION }} \\ --parameter-overrides \\ Environment=staging - name: Get Function Names id: functions run: | # ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸé–¢æ•°ä¸€è¦§ã‚’å–å¾— FUNCTIONS=$(aws cloudformation describe-stack-resources \\ --stack-name lambda-app-staging \\ --query &quot;StackResources[?ResourceType=='AWS::Lambda::Function'].PhysicalResourceId&quot; \\ --output text) echo &quot;functions=$FUNCTIONS&quot; &gt;&gt; $GITHUB_OUTPUT - name: Publish Versions id: versions run: | VERSIONS=&quot;&quot; for FUNCTION in ${{ steps.functions.outputs.functions }}; do VERSION=$(aws lambda publish-version \\ --function-name $FUNCTION \\ --description &quot;Commit: ${{ github.sha }} | Branch: ${{ github.ref_name }}&quot; \\ --query 'Version' \\ --output text) echo &quot;Published $FUNCTION version $VERSION&quot; VERSIONS=&quot;$VERSIONS $FUNCTION:$VERSION&quot; # SSMã«ä¿å­˜ aws ssm put-parameter \\ --name &quot;/apps/$FUNCTION/latest-version&quot; \\ --value &quot;$VERSION&quot; \\ --type String \\ --overwrite # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚‚ä¿å­˜ aws ssm put-parameter \\ --name &quot;/apps/$FUNCTION/version-$VERSION/metadata&quot; \\ --value &quot;{ \\&quot;version\\&quot;: \\&quot;$VERSION\\&quot;, \\&quot;commit\\&quot;: \\&quot;${{ github.sha }}\\&quot;, \\&quot;branch\\&quot;: \\&quot;${{ github.ref_name }}\\&quot;, \\&quot;deployed_at\\&quot;: \\&quot;$(date -u +%Y-%m-%dT%H:%M:%SZ)\\&quot;, \\&quot;deployed_by\\&quot;: \\&quot;${{ github.actor }}\\&quot; }&quot; \\ --type String \\ --overwrite done echo &quot;versions=$VERSIONS&quot; &gt;&gt; $GITHUB_OUTPUT - name: Run Smoke Tests run: | # åŸºæœ¬çš„ãªç–é€šç¢ºèª for FUNCTION in ${{ steps.functions.outputs.functions }}; do echo &quot;Testing $FUNCTION...&quot; aws lambda invoke \\ --function-name $FUNCTION:staging \\ --payload '{&quot;test&quot;: true}' \\ --log-type Tail \\ response.json # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç¢ºèª if grep -q &quot;errorMessage&quot; response.json; then echo &quot;âŒ Smoke test failed for $FUNCTION&quot; cat response.json exit 1 fi echo &quot;âœ… Smoke test passed for $FUNCTION&quot; done - name: Notify Slack if: always() uses: slackapi/slack-github-action@v1 with: webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }} payload: | { &quot;text&quot;: &quot;${{ job.status == 'success' &amp;&amp; 'âœ…' || 'âŒ' }} Staging Deployment&quot;, &quot;blocks&quot;: [ { &quot;type&quot;: &quot;section&quot;, &quot;text&quot;: { &quot;type&quot;: &quot;mrkdwn&quot;, &quot;text&quot;: &quot;*Staging Deployment ${{ job.status }}*\\n\\n*Commit:* ${{ github.sha }}\\n*Branch:* ${{ github.ref_name }}\\n*Author:* ${{ github.actor }}\\n*Versions:* ${{ steps.versions.outputs.versions }}&quot; } }, { &quot;type&quot;: &quot;actions&quot;, &quot;elements&quot;: [ { &quot;type&quot;: &quot;button&quot;, &quot;text&quot;: {&quot;type&quot;: &quot;plain_text&quot;, &quot;text&quot;: &quot;View Workflow&quot;}, &quot;url&quot;: &quot;${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}&quot; }, { &quot;type&quot;: &quot;button&quot;, &quot;text&quot;: {&quot;type&quot;: &quot;plain_text&quot;, &quot;text&quot;: &quot;Request Production Release&quot;}, &quot;url&quot;: &quot;${{ github.server_url }}/${{ github.repository }}/actions/workflows/release-production.yml&quot;, &quot;style&quot;: &quot;primary&quot; } ] } ] } Productionæ‰‹å‹•ãƒªãƒªãƒ¼ã‚¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200# .github/workflows/release-production.ymlname: Release to Productionon: workflow_dispatch: inputs: function_name: description: 'Function name to release' required: true type: choice options: - user-login-function - user-logout-function - create-order-function - process-payment-function version: description: 'Version number to release (from staging)' required: true type: string strategy: description: 'Release strategy' required: true type: choice options: - immediate - canary-10 - blue-green default: canary-10env: AWS_REGION: ap-northeast-1jobs: validate: runs-on: ubuntu-latest outputs: current_version: ${{ steps.current.outputs.version }} metadata: ${{ steps.metadata.outputs.data }} steps: - name: Configure AWS Credentials uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: ${{ secrets.AWS_LAMBDA_DEPLOY_ROLE }} aws-region: ${{ env.AWS_REGION }} - name: Get Current Production Version id: current run: | CURRENT=$(aws lambda get-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --query 'FunctionVersion' \\ --output text) echo &quot;version=$CURRENT&quot; &gt;&gt; $GITHUB_OUTPUT echo &quot;Current production version: $CURRENT&quot; - name: Validate New Version Exists run: | aws lambda get-function \\ --function-name ${{ inputs.function_name }} \\ --qualifier ${{ inputs.version }} echo &quot;âœ… Version ${{ inputs.version }} exists&quot; - name: Get Version Metadata id: metadata run: | METADATA=$(aws ssm get-parameter \\ --name &quot;/apps/${{ inputs.function_name }}/version-${{ inputs.version }}/metadata&quot; \\ --query 'Parameter.Value' \\ --output text 2&gt;/dev/null || echo '{}') echo &quot;data=$METADATA&quot; &gt;&gt; $GITHUB_OUTPUT echo &quot;Version metadata:&quot; echo &quot;$METADATA&quot; | jq . approve: needs: validate runs-on: ubuntu-latest # æœ¬ç•ªç’°å¢ƒï¼ˆæ‰¿èªå¿…é ˆï¼‰ environment: name: production url: https://production.example.com steps: - name: Approval Required run: | echo &quot;â³ Waiting for approval to release to production&quot; echo &quot;Function: ${{ inputs.function_name }}&quot; echo &quot;Version: ${{ inputs.version }}&quot; echo &quot;Current: ${{ needs.validate.outputs.current_version }}&quot; echo &quot;Strategy: ${{ inputs.strategy }}&quot; release: needs: [validate, approve] runs-on: ubuntu-latest steps: - name: Checkout scripts uses: actions/checkout@v4 with: sparse-checkout: | scripts/ - name: Configure AWS Credentials uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: ${{ secrets.AWS_LAMBDA_DEPLOY_ROLE }} aws-region: ${{ env.AWS_REGION }} - name: Release - Immediate if: inputs.strategy == 'immediate' run: | aws lambda update-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --function-version ${{ inputs.version }} echo &quot;âœ… Immediately released version ${{ inputs.version }}&quot; - name: Release - Canary 10% if: inputs.strategy == 'canary-10' run: | echo &quot;Phase 1: Route 10% traffic to new version&quot; aws lambda update-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --function-version ${{ needs.validate.outputs.current_version }} \\ --routing-config &quot;{\\&quot;AdditionalVersionWeights\\&quot;: {\\&quot;${{ inputs.version }}\\&quot;: 0.1}}&quot; echo &quot;Monitoring for 10 minutes...&quot; sleep 600 # ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ ERROR_RATE=$(aws cloudwatch get-metric-statistics \\ --namespace AWS/Lambda \\ --metric-name Errors \\ --dimensions Name=FunctionName,Value=${{ inputs.function_name }} Name=Resource,Value=${{ inputs.function_name }}:production \\ --start-time $(date -u -d '10 minutes ago' +%Y-%m-%dT%H:%M:%S) \\ --end-time $(date -u +%Y-%m-%dT%H:%M:%S) \\ --period 600 \\ --statistics Sum \\ --query 'Datapoints[0].Sum' \\ --output text) echo &quot;Error count in last 10 minutes: $ERROR_RATE&quot; if [ &quot;$ERROR_RATE&quot; != &quot;None&quot; ] &amp;&amp; [ &quot;$ERROR_RATE&quot; -gt 10 ]; then echo &quot;âŒ Error rate too high! Rolling back...&quot; aws lambda update-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --function-version ${{ needs.validate.outputs.current_version }} exit 1 fi echo &quot;Phase 2: Route 100% traffic to new version&quot; aws lambda update-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --function-version ${{ inputs.version }} echo &quot;âœ… Canary release completed successfully&quot; - name: Verify Release run: | CURRENT=$(aws lambda get-alias \\ --function-name ${{ inputs.function_name }} \\ --name production \\ --query 'FunctionVersion' \\ --output text) if [ &quot;$CURRENT&quot; == &quot;${{ inputs.version }}&quot; ]; then echo &quot;âœ… Production is now running version ${{ inputs.version }}&quot; else echo &quot;âŒ Verification failed - production version is $CURRENT&quot; exit 1 fi - name: Notify Slack if: always() uses: slackapi/slack-github-action@v1 with: webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }} payload: | { &quot;text&quot;: &quot;${{ job.status == 'success' &amp;&amp; 'âœ…' || 'âŒ' }} Production Release&quot;, &quot;blocks&quot;: [ { &quot;type&quot;: &quot;section&quot;, &quot;text&quot;: { &quot;type&quot;: &quot;mrkdwn&quot;, &quot;text&quot;: &quot;*Production Release ${{ job.status }}*\\n\\n*Function:* ${{ inputs.function_name }}\\n*Version:* ${{ inputs.version }}\\n*Previous:* ${{ needs.validate.outputs.current_version }}\\n*Strategy:* ${{ inputs.strategy }}\\n*Approved by:* ${{ github.actor }}&quot; } } ] } å¤‰æ›´æ¤œçŸ¥ã¨ãƒ‘ã‚¹æŒ‡å®šåŠ¹ç‡çš„ãªãƒ‡ãƒ—ãƒ­ã‚¤1234567891011121314151617181920212223242526272829303132333435363738394041# å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«å¿œã˜ã¦ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œon: push: branches: [main]jobs: detect-changes: runs-on: ubuntu-latest outputs: functions: ${{ steps.filter.outputs.functions }} layers: ${{ steps.filter.outputs.layers }} template: ${{ steps.filter.outputs.template }} steps: - uses: actions/checkout@v4 with: fetch-depth: 0 - uses: dorny/paths-filter@v2 id: filter with: filters: | functions: - 'functions/**' layers: - 'layers/**' template: - 'template.yaml' - 'samconfig.toml' deploy: needs: detect-changes if: | needs.detect-changes.outputs.functions == 'true' || needs.detect-changes.outputs.layers == 'true' || needs.detect-changes.outputs.template == 'true' runs-on: ubuntu-latest steps: # ãƒ‡ãƒ—ãƒ­ã‚¤å‡¦ç† å‘½åè¦å‰‡ã¨ã‚¿ã‚°æˆ¦ç•¥ãƒªã‚½ãƒ¼ã‚¹å‘½åè¦å‰‡1234567891011121314151617181920212223242526272829303132åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³:{project}-{resource-type}-{environment}-{purpose}ä¾‹:- myapp-lambda-prod-user-auth- myapp-rds-prod-main- myapp-s3-prod-dataLambdaé–¢æ•°:{purpose}-functionä¾‹:- user-login-function- create-order-function- process-payment-functionLayer:{purpose}-layerä¾‹:- dependencies-layer- company-utils-layerã‚¨ã‚¤ãƒªã‚¢ã‚¹:- development- staging- productionï¼ˆå…¨ã¦å°æ–‡å­—ã€çµ±ä¸€ï¼‰SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:/shared/{service}/{resource-type}/{name}/apps/{function-name}/{key} ã‚¿ã‚°æˆ¦ç•¥123456789101112131415161718192021# å…¨ãƒªã‚½ãƒ¼ã‚¹å…±é€šã‚¿ã‚°locals { common_tags = { Project = var.project_name Environment = var.environment ManagedBy = &quot;Terraform&quot; # or &quot;SAM&quot; Team = var.team_name CostCenter = var.cost_center }}# ãƒªã‚½ãƒ¼ã‚¹å›ºæœ‰ã‚¿ã‚°resource &quot;aws_lambda_function&quot; &quot;example&quot; { tags = merge( local.common_tags, { Purpose = &quot;UserAuthentication&quot; Runtime = &quot;Python3.11&quot; } )} ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …OIDCèªè¨¼ã®è¨­å®š12345678910111213141516171819202122232425262728293031323334353637383940414243# GitHub Actionsã‹ã‚‰AWSã¸ã®èªè¨¼# Terraformå´resource &quot;aws_iam_openid_connect_provider&quot; &quot;github&quot; { url = &quot;https://token.actions.githubusercontent.com&quot; client_id_list = [ &quot;sts.amazonaws.com&quot; ] thumbprint_list = [ &quot;6938fd4d98bab03faadb97b34396831e3780aea1&quot; ]}resource &quot;aws_iam_role&quot; &quot;github_actions&quot; { name = &quot;github-actions-lambda-deploy&quot; assume_role_policy = jsonencode({ Version = &quot;2012-10-17&quot; Statement = [{ Effect = &quot;Allow&quot; Principal = { Federated = aws_iam_openid_connect_provider.github.arn } Action = &quot;sts:AssumeRoleWithWebIdentity&quot; Condition = { StringEquals = { &quot;token.actions.githubusercontent.com:aud&quot; = &quot;sts.amazonaws.com&quot; } StringLike = { &quot;token.actions.githubusercontent.com:sub&quot; = &quot;repo:your-org/lambda-applications:*&quot; } } }] })}# GitHub Actionså´- uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: arn:aws:iam::123456789012:role/github-actions-lambda-deploy aws-region: ap-northeast-1 ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†æ¨å¥¨: GitHub Secrets: AWS Role ARN Slack Webhook URL AWS Secrets Manager: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ API Key OAuth Token SSM Parameter Store (SecureString): è¨­å®šå€¤ï¼ˆæ©Ÿå¯†ï¼‰ è¨¼æ˜æ›¸ éæ¨å¥¨:âŒ ã‚³ãƒ¼ãƒ‰ã«ç›´æ¥åŸ‹ã‚è¾¼ã¿âŒ ç’°å¢ƒå¤‰æ•°ã«å¹³æ–‡âŒ Gitã«ã‚³ãƒŸãƒƒãƒˆ ç›£è¦–ã¨ãƒ­ã‚®ãƒ³ã‚°CloudWatchè¨­å®š123456789101112131415161718# SAMResources: MyFunction: Type: AWS::Serverless::Function Properties: # ãƒ­ã‚°è¨­å®š LoggingConfig: LogFormat: JSON LogGroup: !Ref MyFunctionLogGroup # ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚° Tracing: Active # X-Rayæœ‰åŠ¹åŒ– MyFunctionLogGroup: Type: AWS::Logs::LogGroup Properties: LogGroupName: !Sub '/aws/lambda/${MyFunction}' RetentionInDays: 7 # staging: 7æ—¥ã€production: 30æ—¥ ã‚¢ãƒ©ãƒ¼ãƒ è¨­å®š12345678910111213141516171819# Terraformresource &quot;aws_cloudwatch_metric_alarm&quot; &quot;lambda_errors&quot; { alarm_name = &quot;${var.function_name}-errors&quot; comparison_operator = &quot;GreaterThanThreshold&quot; evaluation_periods = 2 metric_name = &quot;Errors&quot; namespace = &quot;AWS/Lambda&quot; period = 60 statistic = &quot;Sum&quot; threshold = 10 alarm_description = &quot;Lambda function error rate&quot; dimensions = { FunctionName = var.function_name Resource = &quot;${var.function_name}:production&quot; } alarm_actions = [aws_sns_topic.alerts.arn]} æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè£…ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ç†è§£ã—ãŸã‚‰ã€ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’ç¢ºèªã—ã¾ã™ã€‚ ğŸ‘‰ æ¬¡ã¸: 4. ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦èªè­˜ã™ã¹ãã“ã¨","link":"/2025/11/02/lambda-cicd-03-implementation/"},{"title":"Lambda CI&#x2F;CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ - 4. ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ","text":"ç›®æ¬¡ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨å¯¾ç­– ä»£æ›¿ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®æ¯”è¼ƒ ç§»è¡Œæˆ¦ç•¥ é‹ç”¨ä¸Šã®è€ƒæ…®äº‹é … ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¡ãƒªãƒƒãƒˆ 1. ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢ãƒ¡ãƒªãƒƒãƒˆçŠ¶æ³:å¾“æ¥ â†’ ãƒ‡ãƒ—ãƒ­ã‚¤ = ãƒªãƒªãƒ¼ã‚¹ï¼ˆæœ¬ç•ªã¸ã®å½±éŸ¿ãŒå³åº§ã«ç™ºç”Ÿï¼‰æ”¹å–„ â†’ ãƒ‡ãƒ—ãƒ­ã‚¤ â‰  ãƒªãƒªãƒ¼ã‚¹ï¼ˆå½±éŸ¿ã‚’åˆ¶å¾¡å¯èƒ½ï¼‰ å…·ä½“çš„ãªåŠ¹æœ:âœ“ å–¶æ¥­æ™‚é–“å†…ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã€æŒ‡å®šæ™‚åˆ»ã«ãƒªãƒªãƒ¼ã‚¹å¯èƒ½âœ“ æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ï¼ˆã‚«ãƒŠãƒªã‚¢ã€ãƒ–ãƒ«ãƒ¼ã‚°ãƒªãƒ¼ãƒ³ï¼‰âœ“ ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã«åˆã‚ã›ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ¶å¾¡âœ“ ç¬æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆç§’å˜ä½ï¼‰ å®Ÿä¾‹ã‚·ãƒŠãƒªã‚ª1: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å§‹ã«åˆã‚ã›ãŸæ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ å¾“æ¥: 0æ™‚ã«ãƒ‡ãƒ—ãƒ­ã‚¤ä½œæ¥­ï¼ˆæ·±å¤œä½œæ¥­å¿…é ˆï¼‰ ãƒ‡ãƒ—ãƒ­ã‚¤ã«5-10åˆ† å•é¡Œç™ºç”Ÿæ™‚ã®å¯¾å¿œãŒå›°é›£ æ”¹å–„å¾Œ: å‰æ—¥17æ™‚ã«ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆå–¶æ¥­æ™‚é–“å†…ï¼‰ stagingç’°å¢ƒã§æœ€çµ‚ç¢ºèª 0æ™‚ã«ã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆï¼ˆè‡ªå‹•åŒ–ï¼‰ å•é¡Œç™ºç”Ÿæ™‚ã¯å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ•°ç§’ï¼‰ çµæœ:âœ“ æ·±å¤œä½œæ¥­ã®å‰Šæ¸›âœ“ ãƒªã‚¹ã‚¯ã®æœ€å°åŒ–âœ“ ãƒãƒ¼ãƒ ã®è² æ‹…è»½æ¸› ã‚·ãƒŠãƒªã‚ª2: é‡è¦ãªæ©Ÿèƒ½ã®æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ è¦ä»¶: ã¾ãš10%ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ†ã‚¹ãƒˆ å•é¡Œãªã‘ã‚Œã°å¾ã€…ã«æ‹¡å¤§ å®Ÿè£…: æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ production ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§10%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ 10åˆ†é–“ç›£è¦–ï¼ˆã‚¨ãƒ©ãƒ¼ç‡ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼‰ å•é¡Œãªã— â†’ 50% â†’ 100% å•é¡Œã‚ã‚Š â†’ å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ çµæœ:âœ“ å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿ã‚’å›é¿âœ“ å•é¡Œã®æ—©æœŸç™ºè¦‹âœ“ ãƒ“ã‚¸ãƒã‚¹ãƒªã‚¹ã‚¯ã®æœ€å°åŒ– 2. æ˜ç¢ºãªè²¬ä»»ç¯„å›²ãƒ¡ãƒªãƒƒãƒˆãƒãƒ¼ãƒ æ§‹æˆ: ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ :âœ“ åŸºç›¤ã®å®‰å®šæ€§ã«é›†ä¸­âœ“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†âœ“ ã‚³ã‚¹ãƒˆæœ€é©åŒ–âœ“ ã‚¬ãƒãƒŠãƒ³ã‚¹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒ :âœ“ æ©Ÿèƒ½é–‹ç™ºã«é›†ä¸­âœ“ é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³âœ“ ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã®æä¾›âœ“ å“è³ªå‘ä¸Š è¡çªã®å›é¿:âœ“ äº’ã„ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãŒç‹¬ç«‹âœ“ å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ãŒæ˜ç¢ºâœ“ ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ– åŠ¹æœæ¸¬å®šBeforeï¼ˆTerraformä¸€æœ¬åŒ–ï¼‰: Lambdaå¤‰æ›´ â†’ Terraform plan/applyï¼ˆ10-15åˆ†ï¼‰ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆ ãƒ‡ãƒ—ãƒ­ã‚¤å¾…ã¡æ™‚é–“ãŒé•·ã„ ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦: é€±1-2å› Afterï¼ˆTerraform + SAMåˆ†é›¢ï¼‰: Lambdaå¤‰æ›´ â†’ SAM deployï¼ˆ1-2åˆ†ï¼‰ ã‚¢ãƒ—ãƒªãƒãƒ¼ãƒ ã§å®Œçµ å¾…ã¡æ™‚é–“æœ€å° ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦: æ—¥æ¬¡è¤‡æ•°å› æ”¹å–„:âœ“ ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“: 87%çŸ­ç¸®âœ“ ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦: 10å€å‘ä¸Šâœ“ ãƒãƒ¼ãƒ é–“ã®ä¾å­˜: 90%å‰Šæ¸› 3. é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒªãƒƒãƒˆé–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã®æ¯”è¼ƒ: å¾“æ¥ï¼ˆTerraformã®ã¿ï¼‰: ã‚³ãƒ¼ãƒ‰å¤‰æ›´ ãƒ“ãƒ«ãƒ‰ï¼ˆæ‰‹å‹•ï¼‰ Terraform planï¼ˆå…¨ä½“ï¼‰ ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ Terraform apply ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†åˆè¨ˆ: 20-30åˆ† æ”¹å–„å¾Œï¼ˆSAMï¼‰: ã‚³ãƒ¼ãƒ‰å¤‰æ›´ sam buildï¼ˆè‡ªå‹•ï¼‰ sam deploy ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†åˆè¨ˆ: 2-3åˆ† åŠ¹æœ:âœ“ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã®é«˜é€ŸåŒ–âœ“ è©¦è¡ŒéŒ¯èª¤ãŒå®¹æ˜“âœ“ ç”Ÿç”£æ€§ã®å‘ä¸Š ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ12345678910111213# SAMã®å¼·åŠ›ãªæ©Ÿèƒ½# ãƒ­ãƒ¼ã‚«ãƒ«ã§Lambdaå®Ÿè¡Œ$ sam local invoke UserLoginFunction \\ --event events/login-event.json# ãƒ­ãƒ¼ã‚«ãƒ«ã§API Gatewayèµ·å‹•$ sam local start-api# â†’ http://localhost:3000 ã§ãƒ†ã‚¹ãƒˆå¯èƒ½# ãƒ­ãƒ¼ã‚«ãƒ«ã§Layerãƒ†ã‚¹ãƒˆ$ sam local invoke \\ --layer-cache-basedir ./layer-cache ãƒ¡ãƒªãƒƒãƒˆ:âœ“ AWSã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ä¸è¦âœ“ é«˜é€Ÿãªå‹•ä½œç¢ºèªâœ“ ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“âœ“ é–‹ç™ºã‚³ã‚¹ãƒˆã®å‰Šæ¸› 4. Layerç®¡ç†ã®è‡ªå‹•åŒ–ãƒ¡ãƒªãƒƒãƒˆBeforeï¼ˆTerraformã®ã¿ï¼‰: ä¾å­˜é–¢ä¿‚ã‚’æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«$ pip install -r requirements.txt -t python/ æ‰‹å‹•ã§zipä½œæˆ$ zip -r layer.zip python/ Terraformã§ç®¡ç†source_code_hash = filebase64sha256(â€œlayer.zipâ€) å¤‰æ›´æ¤œçŸ¥ãŒä¸å®Œå…¨ ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé…ã„ Afterï¼ˆSAMï¼‰: requirements.txt ã‚’æ›´æ–° sam buildâ†’ è‡ªå‹•çš„ã«ãƒ“ãƒ«ãƒ‰â†’ è‡ªå‹•çš„ã«Layerä½œæˆâ†’ ä¾å­˜é–¢ä¿‚è§£æ±º sam deployâ†’ è‡ªå‹•çš„ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰â†’ è‡ªå‹•çš„ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† åŠ¹æœ:âœ“ ä½œæ¥­æ™‚é–“: 80%å‰Šæ¸›âœ“ ãƒŸã‚¹ã®é˜²æ­¢âœ“ ä¸€è²«æ€§ã®ç¢ºä¿ å…·ä½“ä¾‹123456789101112131415161718192021222324# SAMãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰Resources: DependenciesLayer: Type: AWS::Serverless::LayerVersion Properties: ContentUri: layers/dependencies/ CompatibleRuntimes: - python3.11 Metadata: BuildMethod: python3.11 # ã“ã‚Œã ã‘ã§è‡ªå‹•ãƒ“ãƒ«ãƒ‰# è¤‡æ•°é–¢æ•°ã§å…±æœ‰ Function1: Type: AWS::Serverless::Function Properties: Layers: - !Ref DependenciesLayer Function2: Type: AWS::Serverless::Function Properties: Layers: - !Ref DependenciesLayer ãƒ¡ãƒªãƒƒãƒˆ:âœ“ Layeræ›´æ–°æ™‚ã€å…¨é–¢æ•°ã«è‡ªå‹•åæ˜ âœ“ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒè‡ªå‹•âœ“ è¨­å®šãƒŸã‚¹ã®é˜²æ­¢ 5. ã‚¬ãƒãƒŠãƒ³ã‚¹ã®ç¢ºä¿ãƒ¡ãƒªãƒƒãƒˆæ‰¿èªãƒ•ãƒ­ãƒ¼: Stagingï¼ˆè‡ªå‹•ï¼‰: Pull Requestæ‰¿èª è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ QAç¢ºèª Productionï¼ˆæ‰‹å‹•æ‰¿èªï¼‰: ãƒªãƒªãƒ¼ã‚¹ç”³è«‹ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ æ‰¿èª ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç¢ºèª æ‰¿èªå¾Œãƒªãƒªãƒ¼ã‚¹ åŠ¹æœ:âœ“ å¤‰æ›´ã®å¯è¦–åŒ–âœ“ ãƒªã‚¹ã‚¯ç®¡ç†âœ“ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œâœ“ ç›£æŸ»è¨¼è·¡ã®ç¢ºä¿ ç›£æŸ»è¨¼è·¡è¨˜éŒ²ã•ã‚Œã‚‹æƒ…å ±: ã‚³ãƒ¼ãƒ‰å¤‰æ›´: Git commitå±¥æ­´ Pull Request ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆ æ‰¿èªè€… ãƒ‡ãƒ—ãƒ­ã‚¤å±¥æ­´: GitHub Actionså®Ÿè¡Œãƒ­ã‚° ãƒ‡ãƒ—ãƒ­ã‚¤æ—¥æ™‚ å®Ÿè¡Œè€… æˆåŠŸ/å¤±æ•— ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±: Lambda Versionç•ªå· SSM Parameter Store ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆcommitã€æ—¥æ™‚ã€å®Ÿè¡Œè€…ï¼‰ ãƒªãƒªãƒ¼ã‚¹å±¥æ­´: ã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆå±¥æ­´ CloudTrail æ‰¿èªè€… ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å±¥æ­´ ç”¨é€”:âœ“ éšœå®³èª¿æŸ»âœ“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»âœ“ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å ±å‘Š ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨å¯¾ç­–1. è¤‡é›‘æ€§ã®å¢—åŠ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆå•é¡Œ: 2ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªç®¡ç† 2ã¤ã®ãƒ„ãƒ¼ãƒ«ï¼ˆTerraformã€SAMï¼‰ç¿’å¾— é€£æºãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®ç†è§£å¿…è¦ æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼ã®ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ™‚é–“å¢—åŠ  å½±éŸ¿: å­¦ç¿’ã‚³ã‚¹ãƒˆ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ã®å¿…è¦æ€§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®é›£æ˜“åº¦ä¸Šæ˜‡ å¯¾ç­–å¯¾ç­–1: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™å®Ÿæ–½: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ï¼ˆæœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰ é‹ç”¨æ‰‹é †æ›¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ FAQ å¯¾ç­–2: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ»ã‚µãƒ³ãƒ—ãƒ«æä¾›å®Ÿæ–½: æ–°è¦Lambdaé–¢æ•°ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ã‚ˆãã‚ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚µãƒ³ãƒ—ãƒ« GitHub Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ å¯¾ç­–3: ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿæ–½: æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼å‘ã‘ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚° ãƒšã‚¢ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ãƒ¡ãƒ³ã‚¿ãƒ¼åˆ¶åº¦ å¯¾ç­–4: ãƒ„ãƒ¼ãƒ«ã®æ¨™æº–åŒ–å®Ÿæ–½: CLIãƒ„ãƒ¼ãƒ«ï¼ˆsam, terraformï¼‰ VS Codeæ‹¡å¼µæ©Ÿèƒ½ ãƒ—ãƒªã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ 2. ãƒªãƒªãƒ¼ã‚¹å¾…ã¡æ™‚é–“ãƒ‡ãƒ¡ãƒªãƒƒãƒˆå•é¡Œ:stagingãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€productionæ‰¿èªå¾…ã¡ ãƒ•ãƒ­ãƒ¼: ã‚³ãƒŸãƒƒãƒˆ stagingè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ2åˆ†ï¼‰ QAç¢ºèªï¼ˆ30åˆ†-æ•°æ™‚é–“ï¼‰ ãƒªãƒªãƒ¼ã‚¹ç”³è«‹ ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ æ‰¿èªå¾…ã¡ï¼ˆçŠ¶æ³ã«ã‚ˆã‚Šæ•°æ™‚é–“ï¼‰ production ãƒªãƒªãƒ¼ã‚¹ æ‡¸å¿µ: ç·Šæ€¥æ™‚ã®å¯¾å¿œé…å»¶ ãƒ“ã‚¸ãƒã‚¹æ©Ÿä¼šã®æå¤± å¯¾ç­–å¯¾ç­–1: æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–å®Ÿæ–½: ç·Šæ€¥ãƒªãƒªãƒ¼ã‚¹ç”¨ã®ç‰¹åˆ¥ãƒ•ãƒ­ãƒ¼ ã‚ªãƒ³ã‚³ãƒ¼ãƒ«ä½“åˆ¶ Slacké€šçŸ¥ + ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯æ‰¿èª å–¶æ¥­æ™‚é–“å¤–ã®å¯¾å¿œãƒ«ãƒ¼ãƒ«æ˜ç¢ºåŒ– å¯¾ç­–2: è‡ªå‹•æ‰¿èªã®æ¡ä»¶å®šç¾©å®Ÿæ–½: ä½ãƒªã‚¹ã‚¯å¤‰æ›´ã¯è‡ªå‹•æ‰¿èªä¾‹: ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å¤‰æ›´ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆèª¿æ•´ é‡è¦åº¦ã«ã‚ˆã‚‹åˆ†é¡ Critical: æ‰‹å‹•æ‰¿èªå¿…é ˆ High: ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ æ‰¿èª Medium: ãƒªãƒ¼ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æ‰¿èª Low: è‡ªå‹•æ‰¿èª å¯¾ç­–3: ãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ•ãƒ­ãƒ¼å®Ÿæ–½:ç·Šæ€¥æ™‚ï¼ˆæœ¬ç•ªéšœå®³ç­‰ï¼‰: ãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ–ãƒ©ãƒ³ãƒä½œæˆ æœ€å°é™ã®ä¿®æ­£ å³åº§ã«productionç›´æ¥ãƒ‡ãƒ—ãƒ­ã‚¤ äº‹å¾Œãƒ¬ãƒ“ãƒ¥ãƒ¼ å¯¾ç­–4: æ™‚é–“å¸¯ã«ã‚ˆã‚‹ãƒ•ãƒ­ãƒ¼å¤‰æ›´å®Ÿæ–½:å–¶æ¥­æ™‚é–“å†…: é€šå¸¸ã®æ‰¿èªãƒ•ãƒ­ãƒ¼å–¶æ¥­æ™‚é–“å¤–ãƒ»ä¼‘æ—¥: è‡ªå‹•æ‰¿èªï¼ˆç›£è¦–å¼·åŒ–ï¼‰ ç¿Œå–¶æ¥­æ—¥ã«äº‹å¾Œãƒ¬ãƒ“ãƒ¥ãƒ¼ 3. ç®¡ç†ã‚³ã‚¹ãƒˆãƒ‡ãƒ¡ãƒªãƒƒãƒˆå•é¡Œ: 2ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã®ç®¡ç† CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ç¶­æŒ SSM Parameter Storeã®ç®¡ç† ä¾å­˜é–¢ä¿‚ã®åŒæœŸ ã‚³ã‚¹ãƒˆ: ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ ã®ä½œæ¥­æ™‚é–“å¢—åŠ  ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å·¥æ•° å¯¾ç­–å¯¾ç­–1: è‡ªå‹•åŒ–ã®å¾¹åº•å®Ÿæ–½: Renovate/Dependabotã§ä¾å­˜é–¢ä¿‚è‡ªå‹•æ›´æ–° Terraformã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ– SAMãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å†åˆ©ç”¨ GitHub Actionsã®å…±é€šåŒ– å¯¾ç­–2: ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆå®Ÿæ–½: ãƒ‡ãƒ—ãƒ­ã‚¤å¤±æ•—ã®è‡ªå‹•æ¤œçŸ¥ Slackã¸ã®è‡ªå‹•é€šçŸ¥ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ•´å‚™ ç•°å¸¸æ¤œçŸ¥ã®è‡ªå‹•åŒ– å¯¾ç­–3: ãƒ„ãƒ¼ãƒ«çµ±åˆå®Ÿæ–½: terraform-docsã§è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ SAM CLIã®CI/CDçµ±åˆ å…±é€šã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ•´å‚™ 4. ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç†ã®æ‰‹å‹•æ“ä½œãƒ‡ãƒ¡ãƒªãƒƒãƒˆå•é¡Œ:production ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®æ‰‹å‹•åˆ‡ã‚Šæ›¿ãˆ ãƒªã‚¹ã‚¯: äººçš„ãƒŸã‚¹ï¼ˆé–“é•ã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šï¼‰ æ‰‹é †ã®æŠœã‘æ¼ã‚Œ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã®å¤±æ•— å¯¾ç­–å¯¾ç­–1: ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ãƒ»è‡ªå‹•åŒ–å®Ÿæ–½: ãƒªãƒªãƒ¼ã‚¹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ•´å‚™ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ•´å‚™ ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œè¨¼ã®è‡ªå‹•åŒ– ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã®è‡ªå‹•åŒ– å¯¾ç­–2: GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿæ–½: workflow_dispatchï¼ˆæ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼ï¼‰ ãƒãƒ¼ã‚¸ãƒ§ãƒ³é¸æŠã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ è‡ªå‹•æ¤œè¨¼ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ å¯¾ç­–3: å¤šæ®µéšç¢ºèªå®Ÿæ–½: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å­˜åœ¨ç¢ºèª ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º æ‰¿èªï¼ˆGitHub Environmentï¼‰ ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œ æ¤œè¨¼ é€šçŸ¥ å¯¾ç­–4: ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³æ©Ÿèƒ½å®Ÿæ–½: å®Ÿè¡Œå‰ã«å½±éŸ¿ç¢ºèª å¤‰æ›´å†…å®¹ã®è¡¨ç¤º â€“dry-run ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ä»£æ›¿ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®æ¯”è¼ƒã‚¢ãƒ—ãƒ­ãƒ¼ãƒ1: Terraformå®Œå…¨ç®¡ç†æ§‹æˆ: å…¨ã¦Terraformã§ç®¡ç† Lambdaé–¢æ•°ã‚‚Terraform ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚‚Terraform ãƒ¡ãƒªãƒƒãƒˆ:âœ“ ãƒ„ãƒ¼ãƒ«ãŒ1ã¤ï¼ˆå­¦ç¿’ã‚³ã‚¹ãƒˆä½ï¼‰âœ“ çŠ¶æ…‹ç®¡ç†ãŒçµ±ä¸€âœ“ ä¸€è²«æ€§ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:âœ— Lambdaé–‹ç™ºä½“é¨“ãŒæ‚ªã„âœ— ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé…ã„ï¼ˆ10-15åˆ†ï¼‰âœ— ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãŒå›°é›£âœ— Layerç®¡ç†ãŒç…©é›‘âœ— ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ãŒè¤‡é›‘ è©•ä¾¡:å°è¦æ¨¡ï¼ˆLambda 10å€‹æœªæº€ï¼‰: â­â­â­ä¸­è¦æ¨¡ï¼ˆ10-50å€‹ï¼‰: â­â­å¤§è¦æ¨¡ï¼ˆ50å€‹ä»¥ä¸Šï¼‰: â­ éæ¨å¥¨ ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ2: SAMå®Œå…¨ç®¡ç†æ§‹æˆ: å…¨ã¦SAMã§ç®¡ç† ã‚¤ãƒ³ãƒ•ãƒ©ã‚‚SAMï¼ˆCloudFormationï¼‰ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚‚SAM ãƒ¡ãƒªãƒƒãƒˆ:âœ“ ãƒ„ãƒ¼ãƒ«ãŒ1ã¤âœ“ Lambdaæœ€é©åŒ–âœ“ ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé«˜é€Ÿâœ“ é–‹ç™ºä½“é¨“ãŒè‰¯ã„ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:âœ— æ—¢å­˜Terraformè³‡ç”£ã‚’æ´»ç”¨ã§ããªã„âœ— CloudFormationã®åˆ¶ç´„âœ— è¤‡é›‘ãªã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ãŒå›°é›£âœ— çµ„ç¹”æ¨™æº–ã¨ç•°ãªã‚‹å¯èƒ½æ€§ è©•ä¾¡:æ—¢å­˜Terraformè³‡ç”£ãªã—: â­â­â­â­æ—¢å­˜Terraformè³‡ç”£ã‚ã‚Š: â­â­å¤§è¦æ¨¡ã‚¤ãƒ³ãƒ•ãƒ©: â­ ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ3: Serverless Frameworkæ§‹æˆ: Serverless Frameworkã§ç®¡ç† ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§æ‹¡å¼µ ãƒ¡ãƒªãƒƒãƒˆ:âœ“ Lambdaç‰¹åŒ–âœ“ è±Šå¯Œãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³âœ“ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒå¤§ãã„âœ“ ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰å¯¾å¿œ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:âœ— æ—¢å­˜Terraformè³‡ç”£ã‚’æ´»ç”¨ã§ããªã„âœ— çµ„ç¹”æ¨™æº–ã¨ç•°ãªã‚‹âœ— AWSå¤–ã®å­¦ç¿’ã‚‚å¿…è¦âœ— ä¸å¤‰æ€§ã®ç®¡ç†ãŒå¼±ã„ è©•ä¾¡:æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: â­â­â­æ—¢å­˜Terraformç’°å¢ƒ: â­â­ ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ4: Terraform + SAMï¼ˆæ¨å¥¨ï¼‰æ§‹æˆ: ã‚¤ãƒ³ãƒ•ãƒ©: Terraform Lambda: SAM é€£æº: SSM Parameter Store ãƒ¡ãƒªãƒƒãƒˆ:âœ“ æ—¢å­˜è³‡ç”£æ´»ç”¨âœ“ é©æé©æ‰€ã®ãƒ„ãƒ¼ãƒ«é¸æŠâœ“ è²¬ä»»ç¯„å›²ãŒæ˜ç¢ºâœ“ Lambdaé–‹ç™ºä½“é¨“ãŒè‰¯ã„âœ“ é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:âœ— è¤‡é›‘æ€§ã®å¢—åŠ âœ— å­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„âœ— ç®¡ç†ã‚³ã‚¹ãƒˆ è©•ä¾¡:å°è¦æ¨¡: â­â­â­ä¸­è¦æ¨¡: â­â­â­â­â­ æ¨å¥¨å¤§è¦æ¨¡: â­â­â­â­â­ æ¨å¥¨æ—¢å­˜Terraformç’°å¢ƒ: â­â­â­â­â­ æœ€é© ç§»è¡Œæˆ¦ç•¥ãƒ•ã‚§ãƒ¼ã‚º1: æº–å‚™ï¼ˆ1-2é€±é–“ï¼‰ç›®æ¨™: ç’°å¢ƒæº–å‚™ ãƒãƒ¼ãƒ æ•™è‚² ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸å®š ã‚¿ã‚¹ã‚¯: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ ç§»è¡Œè¨ˆç”»æ›¸ é‹ç”¨æ‰‹é †æ›¸ ç’°å¢ƒæ§‹ç¯‰: ãƒªãƒã‚¸ãƒˆãƒªä½œæˆ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŸºç›¤ SSM Parameter Storeè¨­è¨ˆ ãƒãƒ¼ãƒ æ•™è‚²: SAMåŸºç¤ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚° ãƒãƒ³ã‚ºã‚ªãƒ³ Q&amp;Aã‚»ãƒƒã‚·ãƒ§ãƒ³ ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆé¸å®š: ä½ãƒªã‚¹ã‚¯ãªLambdaé–¢æ•°é¸å®š 3-5å€‹ç¨‹åº¦ é »ç¹ã«å¤‰æ›´ã•ã‚Œã‚‹ã‚‚ã®å„ªå…ˆ ãƒ•ã‚§ãƒ¼ã‚º2: ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆå®Ÿæ–½ï¼ˆ2-4é€±é–“ï¼‰ç›®æ¨™: å°è¦æ¨¡ã§å®Ÿè¨¼ å•é¡Œç‚¹ã®æ´—ã„å‡ºã— ãƒ—ãƒ­ã‚»ã‚¹ã®æ”¹å–„ æ‰‹é †: Terraformå´æº–å‚™: SSM Parameter Storeå‡ºåŠ› IAMãƒ­ãƒ¼ãƒ«æ•´å‚™ SAMå´å®Ÿè£…: é¸å®šã—ãŸé–¢æ•°ã‚’SAMåŒ– Layerã®ç§»è¡Œ ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®š CI/CDæ§‹ç¯‰: GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ stagingè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ productionæ‰‹å‹•ãƒªãƒªãƒ¼ã‚¹ æ¤œè¨¼: ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“æ¸¬å®š å•é¡Œç‚¹ã®è¨˜éŒ² ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›† æ”¹å–„: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„ ãƒ„ãƒ¼ãƒ«æ”¹å–„ ãƒ•ã‚§ãƒ¼ã‚º3: æ®µéšçš„å±•é–‹ï¼ˆ2-3ãƒ¶æœˆï¼‰ç›®æ¨™: å…¨Lambdaé–¢æ•°ã®ç§»è¡Œ ãƒãƒ¼ãƒ å…¨ä½“ã¸ã®å±•é–‹ å„ªå…ˆé †ä½: é«˜é »åº¦å¤‰æ›´ã®é–¢æ•° æ¯é€±å¤‰æ›´ã•ã‚Œã‚‹ã‚‚ã® ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ä¸­å¿ƒ Layerç®¡ç†ãŒå¿…è¦ãªé–¢æ•° ä¾å­˜é–¢ä¿‚ãŒå¤šã„ å…±é€šã‚³ãƒ¼ãƒ‰ä½¿ç”¨ ãã®ä»–ã®é–¢æ•° ä½é »åº¦å¤‰æ›´ ã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•° ãƒšãƒ¼ã‚¹: Week 1-2: 10é–¢æ•° Week 3-4: 20é–¢æ•° Week 5-6: 30é–¢æ•° â€¦ æ³¨æ„ç‚¹: ç„¡ç†ã«å…¨ã¦ç§»è¡Œã—ãªã„ å•é¡ŒãŒå‡ºãŸã‚‰ç«‹ã¡æ­¢ã¾ã‚‹ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åæ˜  ãƒ•ã‚§ãƒ¼ã‚º4: å®‰å®šåŒ–ï¼ˆ1ãƒ¶æœˆï¼‰ç›®æ¨™: é‹ç”¨ã®å®šç€ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œæˆ KPIç¢ºèª ã‚¿ã‚¹ã‚¯: é‹ç”¨ç›£è¦–: ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦ ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ å¤±æ•—ç‡ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å›æ•° ãƒãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯: é–‹ç™ºè€…æº€è¶³åº¦ å•é¡Œç‚¹åé›† æ”¹å–„è¦æœ› ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œæˆ: ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ FAQ KPIè©•ä¾¡:Before vs After: ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦ ç”Ÿç”£æ€§ éšœå®³å¯¾å¿œæ™‚é–“ é‹ç”¨ä¸Šã®è€ƒæ…®äº‹é …æ—¥å¸¸é‹ç”¨é€±æ¬¡ä½œæ¥­: ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ãƒ¬ãƒ“ãƒ¥ãƒ¼ ã‚¨ãƒ©ãƒ¼ç‡ç¢ºèª ã‚³ã‚¹ãƒˆç¢ºèª æœˆæ¬¡ä½œæ¥­: Lambdaé–¢æ•°ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ Layerä½¿ç”¨çŠ¶æ³ç¢ºèª ä¸è¦ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³å‰Šé™¤ IAMãƒ­ãƒ¼ãƒ«ãƒ»ãƒãƒªã‚·ãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼ å››åŠæœŸä½œæ¥­: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¬ãƒ“ãƒ¥ãƒ¼ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» ã‚³ã‚¹ãƒˆæœ€é©åŒ– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦: å•é¡Œ1: SAMãƒ‡ãƒ—ãƒ­ã‚¤å¤±æ•—åŸå› : IAMæ¨©é™ä¸è¶³ SSMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„ ãƒ“ãƒ«ãƒ‰å¤±æ•— å¯¾å‡¦: CloudFormationã‚¹ã‚¿ãƒƒã‚¯ã®ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰åŸå› ç‰¹å®š ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆsam deploy â€“no-execute-changesetï¼‰ å•é¡Œ2: ã‚¨ã‚¤ãƒªã‚¢ã‚¹åˆ‡ã‚Šæ›¿ãˆå¤±æ•—åŸå› : ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå­˜åœ¨ã—ãªã„ æ¨©é™ä¸è¶³ å¯¾å‡¦: ãƒãƒ¼ã‚¸ãƒ§ãƒ³å­˜åœ¨ç¢ºèª ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç¾åœ¨å€¤ç¢ºèª æ‰‹å‹•ã§AWS CLIã‹ã‚‰åˆ‡ã‚Šæ›¿ãˆ å•é¡Œ3: Layerèª­ã¿è¾¼ã¿å¤±æ•—åŸå› : Layerã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒé–“é•ã„ CompatibleRuntimesãŒä¸€è‡´ã—ãªã„ å¯¾å‡¦: Layerã®æ§‹é€ ç¢ºèªï¼ˆ/opt/python/ï¼‰ ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆï¼ˆsam localï¼‰ ã‚³ã‚¹ãƒˆç®¡ç†ã‚³ã‚¹ãƒˆè¦å› : Lambdaå®Ÿè¡Œ: ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° å®Ÿè¡Œæ™‚é–“ ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚º æœ€é©åŒ–: ä¸è¦ãªãƒ­ã‚°å‰Šæ¸› ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºã®é©æ­£åŒ– å®Ÿè¡Œæ™‚é–“ã®æœ€é©åŒ– Provisioned Concurrencyï¼ˆå¿…è¦æ™‚ã®ã¿ï¼‰ NAT Gateway: AZã”ã¨ã«$0.045/hour ãƒ‡ãƒ¼ã‚¿è»¢é€è²» æœ€é©åŒ–: VPC Endpointæ´»ç”¨ é–‹ç™ºç’°å¢ƒã¯NATä¸è¦ S3ï¼ˆã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¿å­˜ï¼‰: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è²»ç”¨ ãƒªã‚¯ã‚¨ã‚¹ãƒˆè²»ç”¨ æœ€é©åŒ–: ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³å‰Šé™¤ ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰Q1: ãªãœTerraformã¨SAMã®ä¸¡æ–¹ã‚’ä½¿ã†ã®ã‹ï¼ŸA: é©æé©æ‰€ã®ãƒ„ãƒ¼ãƒ«é¸æŠã§ã™ã€‚ ç†ç”±: Terraform: ã‚¤ãƒ³ãƒ•ãƒ©å…¨èˆ¬ã®ç®¡ç†ã«å„ªã‚Œã‚‹æ—¢å­˜è³‡ç”£ãŒã‚ã‚Šã€ãƒãƒ¼ãƒ ãŒç¿’ç†Ÿã—ã¦ã„ã‚‹ SAM: Lambdaå°‚ç”¨ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹é–‹ç™ºä½“é¨“ã€ãƒ‡ãƒ—ãƒ­ã‚¤é€Ÿåº¦ã€Layerç®¡ç†ãŒå„ªç§€ ä¸¡æ–¹ä½¿ã†ã“ã¨ã§:âœ“ æ—¢å­˜è³‡ç”£ã‚’æ´»ç”¨âœ“ Lambdaé–‹ç™ºã®ç”Ÿç”£æ€§å‘ä¸Šâœ“ è²¬ä»»ç¯„å›²ã®æ˜ç¢ºåŒ– Q2: ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã‚’åˆ†é›¢ã™ã‚‹å¿…è¦æ€§ã¯ï¼ŸA: ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã¨ãƒªã‚¹ã‚¯ç®¡ç†ã®ãŸã‚ã§ã™ã€‚ å¿…è¦ãªã‚±ãƒ¼ã‚¹: ç‰¹å®šæ™‚åˆ»ã«ãƒªãƒªãƒ¼ã‚¹ã—ãŸã„ï¼ˆã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç­‰ï¼‰ æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ï¼ˆã‚«ãƒŠãƒªã‚¢ï¼‰ã—ãŸã„ æœ¬ç•ªãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–ã—ãŸã„ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’é«˜é€ŸåŒ–ã—ãŸã„ ä¸è¦ãªã‚±ãƒ¼ã‚¹: å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒè‡ªç”± é–‹ç™ºã‚¹ãƒ”ãƒ¼ãƒ‰æœ€å„ªå…ˆ Q3: æ—¢å­˜ã®Terraformç®¡ç†Lambdaã¯ã©ã†ã™ã‚‹ï¼ŸA: æ®µéšçš„ã«ç§»è¡Œã‚’æ¨å¥¨ã—ã¾ã™ã€‚ ç§»è¡Œå„ªå…ˆé †ä½: é »ç¹ã«å¤‰æ›´ã•ã‚Œã‚‹é–¢æ•° Layerç®¡ç†ãŒå¿…è¦ãªé–¢æ•° æ–°è¦é–¢æ•°ï¼ˆæœ€åˆã‹ã‚‰SAMï¼‰ ãã®ä»–ã®é–¢æ•° ç§»è¡Œä¸è¦: ã‚¤ãƒ³ãƒ•ãƒ©ç³»Lambdaï¼ˆèªè¨¼ã€ç›£è¦–ï¼‰ ã»ã¼å¤‰æ›´ã•ã‚Œãªã„é–¢æ•° Terraformã§å•é¡Œãªã„é–¢æ•° Q4: ã‚¨ã‚¤ãƒªã‚¢ã‚¹ç®¡ç†ã¯å¿…é ˆï¼ŸA: æ¨å¥¨ã—ã¾ã™ãŒã€å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãªã—ã®å ´åˆ: $LATESTã‚„ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç›´æ¥ä½¿ç”¨ ã‚·ãƒ³ãƒ—ãƒ«ã ãŒæŸ”è»Ÿæ€§ãŒãªã„ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒé¢å€’ ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚ã‚Šã®å ´åˆ: ç’°å¢ƒã®æ˜ç¢ºãªåˆ†é›¢ ç¬æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ¶å¾¡ æ¨å¥¨ Q5: SAMã¨Serverless Frameworkã®é•ã„ã¯ï¼ŸA: ã©ã¡ã‚‰ã‚‚Lambdaç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã™ãŒâ€¦ SAMã®ç‰¹å¾´:âœ“ AWSå…¬å¼âœ“ CloudFormationãƒ™ãƒ¼ã‚¹âœ“ AWSçµ±åˆãŒå¼·ã„âœ“ å­¦ç¿’ã‚³ã‚¹ãƒˆä½âœ“ æœ¬ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§æ¨å¥¨ Serverless Frameworkã®ç‰¹å¾´:âœ“ ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰âœ“ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè±Šå¯Œâœ“ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãŒå¤§ãã„âœ“ AWSä»¥å¤–ã‚‚è¦–é‡ã«å…¥ã‚Œã‚‹ãªã‚‰å€™è£œ é¸æŠåŸºæº–: AWSå°‚ç”¨ â†’ SAM ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰ â†’ Serverless Framework Q6: ã‚³ã‚¹ãƒˆå¢—åŠ ã¯ï¼ŸA: ã‚ãšã‹ã«å¢—åŠ ã—ã¾ã™ãŒã€åŠ¹æœãŒä¸Šå›ã‚Šã¾ã™ã€‚ å¢—åŠ è¦å› : SSM Parameter Storeï¼ˆã‚ãšã‹ï¼‰ Lambda ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¿æŒï¼ˆã‚ãšã‹ï¼‰ GitHub Actionså®Ÿè¡Œæ™‚é–“ï¼ˆå¢—åŠ ï¼‰ å‰Šæ¸›è¦å› : ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“çŸ­ç¸® â†’ äººä»¶è²»å‰Šæ¸› éšœå®³å¯¾å¿œæ™‚é–“çŸ­ç¸® â†’ æ©Ÿä¼šæå¤±å‰Šæ¸› é–‹ç™ºé€Ÿåº¦å‘ä¸Š â†’ ç”Ÿç”£æ€§å‘ä¸Š çµè«–:å…¨ä½“ã¨ã—ã¦ã¯ã‚³ã‚¹ãƒˆå‰Šæ¸›åŠ¹æœã®æ–¹ãŒå¤§ãã„ Q7: å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚æœ‰åŠ¹ï¼ŸA: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦æ¨¡ã‚ˆã‚Šã€è¦ä»¶ã§åˆ¤æ–­ã—ã¦ãã ã•ã„ã€‚ æœ‰åŠ¹ãªã‚±ãƒ¼ã‚¹: Lambdaé–¢æ•°ãŒ10å€‹ä»¥ä¸Š é »ç¹ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ è¤‡æ•°ãƒãƒ¼ãƒ ã§é–‹ç™º Layerç®¡ç†ãŒå¿…è¦ ã‚¬ãƒãƒŠãƒ³ã‚¹ãŒé‡è¦ ä¸è¦ãªã‚±ãƒ¼ã‚¹: Lambdaé–¢æ•°ãŒ5å€‹æœªæº€ æœˆ1å›ç¨‹åº¦ã®ãƒ‡ãƒ—ãƒ­ã‚¤ å˜ä¸€ãƒãƒ¼ãƒ  ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆ æ¨å¥¨:Lambda 10å€‹ä»¥ä¸Š â†’ æœ¬ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£Lambda 10å€‹æœªæº€ â†’ ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã‚‚æ¤œè¨ Q8: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ãƒªã‚¹ã‚¯ã¯ï¼ŸA: é©åˆ‡ã«è¨­å®šã™ã‚Œã°ã€ã‚€ã—ã‚å‘ä¸Šã—ã¾ã™ã€‚ æ‡¸å¿µç‚¹: 2ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªç®¡ç† CI/CDã§ã®èªè¨¼æƒ…å ± å¯¾ç­–:âœ“ OIDCèªè¨¼ï¼ˆé•·æœŸèªè¨¼æƒ…å ±ä¸è¦ï¼‰âœ“ æœ€å°æ¨©é™ã®åŸå‰‡âœ“ Secrets Manageræ´»ç”¨âœ“ ç›£æŸ»ãƒ­ã‚°ï¼ˆCloudTrailï¼‰âœ“ å®šæœŸçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ çµè«–:é©åˆ‡ã«å®Ÿè£…ã™ã‚Œã°ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯å‘ä¸Š Q9: ãƒ­ãƒƒã‚¯ã‚¤ãƒ³ï¼ˆãƒ™ãƒ³ãƒ€ãƒ¼ãƒ­ãƒƒã‚¯ï¼‰ã®ãƒªã‚¹ã‚¯ã¯ï¼ŸA: AWSç‰¹åŒ–ã§ã™ãŒã€ãƒ¡ãƒªãƒƒãƒˆãŒä¸Šå›ã‚Šã¾ã™ã€‚ ãƒ­ãƒƒã‚¯ã‚¤ãƒ³ã®ç¨‹åº¦: Terraform: æ¯”è¼ƒçš„ç§»è¡Œã—ã‚„ã™ã„ SAM: AWS CloudFormationä¾å­˜ Lambdaè‡ªä½“: AWSå›ºæœ‰ ç·©å’Œç­–: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ç–çµåˆã« ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ˜ç¢ºã« ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®å……å®Ÿ å®Ÿéš›: ä»–ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ã®ç§»è¡Œã¯ç¨€ AWSã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã®æ©æµãŒå¤§ãã„ ãƒ­ãƒƒã‚¯ã‚¤ãƒ³ã‚’éåº¦ã«æã‚Œã‚‹å¿…è¦ãªã— Q10: å­¦ç¿’ã‚³ã‚¹ãƒˆã¯ã©ã®ãã‚‰ã„ï¼ŸA: çµŒé¨“ã«ã‚‚ã‚ˆã‚Šã¾ã™ãŒâ€¦ å‰æçŸ¥è­˜: LambdaåŸºç¤: å¿…é ˆ TerraformåŸºç¤: ã‚ã‚‹ã¨è‰¯ã„ GitHub ActionsåŸºç¤: ã‚ã‚‹ã¨è‰¯ã„ å­¦ç¿’æ™‚é–“ï¼ˆç›®å®‰ï¼‰: SAMåŸºç¤: 2-3æ—¥ æœ¬ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç†è§£: 1é€±é–“ å®Ÿè£…ç¿’å¾—: 2-4é€±é–“ ã‚µãƒãƒ¼ãƒˆ: æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ãƒãƒ³ã‚ºã‚ªãƒ³ ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ ãƒ¡ãƒ³ã‚¿ãƒ¼åˆ¶åº¦ çµè«–:1ãƒ¶æœˆã‚ã‚Œã°ç¿’å¾—å¯èƒ½ ã¾ã¨ã‚ãƒ¡ãƒªãƒƒãƒˆï¼ˆå†æ²ï¼‰âœ“ ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢âœ“ æ˜ç¢ºãªè²¬ä»»ç¯„å›²âœ“ é«˜é€Ÿãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³âœ“ Layerç®¡ç†ã®è‡ªå‹•åŒ–âœ“ ã‚¬ãƒãƒŠãƒ³ã‚¹ã®ç¢ºä¿âœ“ é–‹ç™ºä½“é¨“ã®å‘ä¸Šâœ“ ç¬æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆï¼ˆå†æ²ï¼‰ã¨å¯¾ç­–âœ— è¤‡é›‘æ€§ã®å¢—åŠ  â†’ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ã€æ•™è‚² âœ— ãƒªãƒªãƒ¼ã‚¹å¾…ã¡æ™‚é–“ â†’ æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã€ç·Šæ€¥ãƒ•ãƒ­ãƒ¼ âœ— ç®¡ç†ã‚³ã‚¹ãƒˆ â†’ è‡ªå‹•åŒ–ã€ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚° âœ— ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ‰‹å‹•ç®¡ç† â†’ ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åŒ– æ¨å¥¨ã™ã‚‹çµ„ç¹”æœ€é©: Lambdaé–¢æ•° 30å€‹ä»¥ä¸Š è¤‡æ•°ãƒãƒ¼ãƒ  æ—¢å­˜Terraformè³‡ç”£ã‚ã‚Š ã‚¬ãƒãƒŠãƒ³ã‚¹é‡è¦– é«˜é »åº¦ãƒ‡ãƒ—ãƒ­ã‚¤ é©ç”¨å¯èƒ½: Lambdaé–¢æ•° 10-30å€‹ å˜ä¸€ãƒãƒ¼ãƒ  ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦ ä¸­ç¨‹åº¦ è¦æ¤œè¨: Lambdaé–¢æ•° 10å€‹æœªæº€ è¶…ã‚·ãƒ³ãƒ—ãƒ«ãªè¦ä»¶ ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ãŒå³ã—ã„ æœ€çµ‚çš„ãªåˆ¤æ–­ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã™ã¹ãã‹ï¼Ÿ YES ã®å ´åˆ:âœ“ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãŒé‡è¦âœ“ é–‹ç™ºé€Ÿåº¦ã‚’ä¸Šã’ãŸã„âœ“ ã‚¬ãƒãƒŠãƒ³ã‚¹ãŒå¿…è¦âœ“ æ—¢ã«Terraformã‚’ä½¿ç”¨âœ“ Lambdaé–¢æ•°ãŒå¤šã„ï¼ˆ10å€‹ä»¥ä¸Šï¼‰ NO ã®å ´åˆï¼ˆä»£æ›¿æ¡ˆæ¤œè¨ï¼‰: Lambdaé–¢æ•°ãŒå°‘ãªã„ï¼ˆ5å€‹æœªæº€ï¼‰ è¶…ã‚·ãƒ³ãƒ—ãƒ«ãªè¦ä»¶ å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹ãŒé™ã‚‰ã‚Œã‚‹ â†’ è¦ä»¶ã¨åˆ¶ç´„ã‚’ç·åˆçš„ã«åˆ¤æ–­ å…¨ä½“ã®ã¾ã¨ã‚æœ¬è¨­è¨ˆæ›¸ã§ã¯ã€å¤§è¦æ¨¡Lambdaç’°å¢ƒã«ãŠã‘ã‚‹CI/CDã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æç¤ºã—ã¾ã—ãŸã€‚ æ ¸å¿ƒçš„ãªä¾¡å€¤ é©æé©æ‰€ã®ãƒ„ãƒ¼ãƒ«é¸æŠ Terraform: ã‚¤ãƒ³ãƒ•ãƒ© SAM: Lambda ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒªãƒªãƒ¼ã‚¹ã®åˆ†é›¢ ãƒªã‚¹ã‚¯ç®¡ç† ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã¸ã®å¯¾å¿œ è²¬ä»»ç¯„å›²ã®æ˜ç¢ºåŒ– ã‚¤ãƒ³ãƒ•ãƒ©ãƒãƒ¼ãƒ  ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒ  ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ é–¢æ•°æ•°ã®å¢—åŠ  ãƒãƒ¼ãƒ æ•°ã®å¢—åŠ  ã‚¬ãƒãƒŠãƒ³ã‚¹ æ‰¿èªãƒ•ãƒ­ãƒ¼ ç›£æŸ»è¨¼è·¡ æˆåŠŸã®éµâœ“ æ®µéšçš„ãªå°å…¥âœ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™âœ“ ãƒãƒ¼ãƒ æ•™è‚²âœ“ ç¶™ç¶šçš„ãªæ”¹å–„âœ“ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ— æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸å®š ãƒãƒ¼ãƒ æ•™è‚²ã®è¨ˆç”» ç§»è¡Œè¨ˆç”»ã®ç­–å®š å®Ÿè¡Œ å‚è€ƒãƒªãƒ³ã‚¯1234567891011AWS SAM:https://docs.aws.amazon.com/serverless-application-model/Terraform:https://www.terraform.io/docsGitHub Actions:https://docs.github.com/actionsLambda Best Practices:https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œ æœ¬è¨­è¨ˆæ›¸ã«ã¤ã„ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚„è³ªå•ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®Issueã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚","link":"/2025/11/02/lambda-cicd-04-tradeoffs/"},{"title":"miseã§ã®Nodeãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†","text":"mise ã®è¨­å®šãƒ¡ãƒ¢ ç’°å¢ƒæƒ…å ± OS macOS Version 15.5 BuildVersion 24F74 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«12curl https://mise.run | shecho 'eval &quot;$(~/.local/bin/mise activate zsh)&quot;' &gt;&gt; ~/.zshrc ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª1mise doctor Node.jsã®è¨­å®š1234mise ls-remote nodemise use node@22.16.0# ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®å ´åˆmise use -g node@22.16.0 ãƒªãƒã‚¸ãƒˆãƒªå†…ã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š.mise.toml 12[tools]node = &quot;22.16.0&quot; 1mise install","link":"/2025/06/22/mise/"},{"title":"Slackã®Incoming Webhooksã«ã¤ã„ã¦","text":"è‡ªåˆ†ã®çŸ¥ã£ã¦ã„ãŸSlackã®Incoming-Webhookã¯Legacyã¨ã—ã¦ã‹ãªã‚Šå‰ã«éæ¨å¥¨ã«ãªã£ã¦ã„ãŸè©±ã€‚ ã‚µãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹æƒ…å ±Discontinuing support for legacy custom bots and classic appsã«ã‚ˆã‚Œã° 2024å¹´6æœˆ: æ–°ã—ã„legacy appsã¨classic appsã®ä½œæˆã‚’ãƒ–ãƒ­ãƒƒã‚¯é–‹å§‹ 2025å¹´3æœˆ31æ—¥: legacy custom botsã®ã‚µãƒãƒ¼ãƒˆçµ‚äº† 2026å¹´5æœˆ25æ—¥: classic appsã®ã‚µãƒãƒ¼ãƒˆçµ‚äº† å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä¸Šè¨˜ã®ã‚‚ã®ã§ã€Legacy Custom Integrationsã«ã‚ãŸã‚‹ã€Legacy Incoming Webhookã¯æ˜ç¢ºã«æœŸæ—¥ã‚’æ±ºã‚ã‚‰ã‚Œã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã•ãã†ã§ã™ã€‚è‰²ã€…ã¨ä»•æ§˜ã®å¤‰æ›´ã«ã¤ã„ã¦ã¯æ›¸ã‹ã‚Œã¦ã„ã¾ã™ãŒã€åŸºæœ¬çš„ã«ã¯payloadã¨ã—ã¦äº’æ›æ€§ã‚‚ã‚ã‚‹ã®ã§ã€ã²ã¨ã¾ãšç§»è¡Œã—ã¦ã—ã¾ã£ãŸæ–¹ãŒç„¡é›£ã¨ã„ã†çµè«–ã§ã™ã€‚ Legacy Incoming Webhook ã¨ Incoming WebhookLegacy Incoming Webhook Incoming Webhookã§ã‚¢ãƒ—ãƒªã‚’æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ We do not recommend their use. ã¨ã„ã†æ³¨æ„æ›¸ããŒä¸Šéƒ¨ã«ã‚ã‚Šã¾ã™ è¨­å®šç”»é¢ãŒï¼‘ç”»é¢ã§å®Œçµã—ã€éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ã‚ã‹ã‚Šã‚„ã™ãè¨­å®šã§ãã¾ã™ Incoming Webhook Slack Appã‚’ã«ã¦Create New Appã‚’é¸æŠ From scratchã‚’é¸æŠã€App Nameã¨workspaceã‚’å…¥åŠ›ã—ã¦Create Basic Informationã®Display Informationã‚’å…¥åŠ› Features &gt; Incoming Webhooks Activate Incoming Webhooks ã‚’ On ã«ã—ã¾ã™ Add New Webhookã§ã€URLã‚’channelã”ã¨ã«ä½œæˆã—ã¾ã™ ãã‚Œãã‚Œã®é•ã„ Legacy Incoming Webhook ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰å†…ã§usernameã€iconã€channelã‚’ä¸Šæ›¸ãã§ãã‚‹ URLçŸ¥ã£ã¦ãŸã‚‰ã©ã®channelã§ã‚‚æ›¸ãè¾¼ã‚ã‚‹ã‚ã‘ã§ã€ã‚ã¾ã‚Šã‚ˆããªã„ä»•æ§˜ã§ã™ã­ ä½œæˆè€…ãŒçµ„ç¹”ã‚’é›¢ã‚Œã‚‹ã¨WebhookãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ç®¡ç†ä¸Šã®å•é¡ŒãŒã‚ã‚Šã¾ã™ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¯attachmentsã§è¡¨ç¾ã—ã¾ã™ Incoming Webhook ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¯Block Kitã‚’ä½¿ç”¨ã—ã¦ã‚ˆã‚Šé«˜åº¦ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆãŒå¯èƒ½ã§ã™ ç§»è¡Œæ–¹æ³•ã¯Migrate your legacy message compositions to blocks ãŸã ã—ã€attachmentsã‚‚éæ¨å¥¨ã§ã™ãŒã€ä½¿ãˆã‚‹ã®ã§äº’æ›æ€§ã¯æ‹…ä¿ã•ã‚Œãã†ã§ã™ ç‰¹ã«è‰²æŒ‡å®šã¯attachmentsã—ã‹è¡¨ç¾ã§ããšã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç·Šæ€¥åº¦ã§è‰²åˆ†ã‘ã—ãŸã„ã‚±ãƒ¼ã‚¹ï¼ˆç›£è¦–ã‚¢ãƒ©ãƒ¼ãƒˆç­‰ï¼‰ã§ã¯ä½¿ã†ã—ã‹ã‚ã‚Šã¾ã›ã‚“ è‰²æŒ‡å®šã«good/warning/dangerã¯ä½¿ãˆãªã„ã¨ã„ã†æƒ…å ±ã‚’è¦‹ã‹ã‘ã¾ã—ãŸãŒã€å•é¡Œãªãä½¿ãˆã¾ã—ãŸã€‚ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚‚OKï¼ˆä¾‹ï¼š#ff0000ï¼‰ attachmentsã§ã®ãƒ†ã‚¹ãƒˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ 1234567891011curl -X POST -H 'Content-type: application/json' \\ --data '{ &quot;text&quot;: &quot;Hello, World!&quot;, &quot;attachments&quot;: [ { &quot;color&quot;: &quot;good&quot;, &quot;text&quot;: &quot;This is a test message&quot; } ] }' \\ https://{YOUR_WEBHOOK_URL}","link":"/2025/06/25/slack_webhooks/"},{"title":"uvã§ã®pythonãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨ä»®æƒ³ç’°å¢ƒç®¡ç†","text":"uv ã®è¨­å®šãƒ¡ãƒ¢ ç’°å¢ƒæƒ…å ± OS macOS Version 15.5 BuildVersion 24F74 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«1brew install uv ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆå›è¨­å®šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§åˆæœŸåŒ–1uv init pyproject.tomlãŒç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€pythonãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®š pyproject.toml 1234567...[project]name = &quot;Project Name&quot;version = &quot;0.1.0&quot;description = &quot;Add your description here&quot;readme = &quot;README.md&quot;requires-python = &quot;&gt;=3.13&quot; requirements.txtã®å–ã‚Šè¾¼ã¿1uv add -r requirements.txt requirements.txtã‚’å–ã‚Šè¾¼ã‚“ã å¾Œã¯å‰Šé™¤ã—ã¦ã‚‚OK pyproject.tomlã‚’ã‚‚ã¨ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«1uv sync dependabot.github/dependabot.yml 123456version: 2updates: - package-ecosystem: &quot;uv&quot; # See documentation for possible values directory: &quot;/&quot; # Location of package manifests schedule: interval: &quot;weekly&quot; .gitignore.gitignore 12345...# uv package manager.uv/uv.lock.uvignore ä½œæ¥­é–‹å§‹æ™‚ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–1. .venv/bin/activate ä½œæ¥­çµ‚äº†æ™‚ä»®æƒ³ç’°å¢ƒã‚’ç„¡åŠ¹åŒ–1deactivate","link":"/2025/06/22/uv/"},{"title":"zed editorã§ã®Bedrockæ¥ç¶šï¼ˆProxyçµŒç”±ï¼‰","text":"zed ã§Amazon Bedrockæ¥ç¶šï¼ˆProxyçµŒç”±ï¼‰ã®è¨­å®šãƒ¡ãƒ¢ ç’°å¢ƒæƒ…å ± OS macOS Version 15.5 å‰æ AWS CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ Bedrockã®ãƒ¢ãƒ‡ãƒ«æœ‰åŠ¹åŒ–AWSãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§åˆ©ç”¨ã—ãŸã„Regionã§Bedrockã®ç”»é¢ã¸ã‚¢ã‚¯ã‚»ã‚¹â€œBedrock configurationsâ€ &gt; â€œãƒ¢ãƒ‡ãƒ«ã‚¢ã‚¯ã‚»ã‚¹â€ ã§æœ‰åŠ¹åŒ–ã—ãŸã„ãƒ¢ãƒ‡ãƒ«ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ Zed ã§ã®Bedrockã®è¨­å®š Authentication via Named Profile (Recommended) Network Proxy Setting.jsonã‚’ç·¨é›† 1234567&quot;language_models&quot;: { &quot;bedrock&quot;: { &quot;authentication_method&quot;: &quot;named_profile&quot;, &quot;region&quot;: &quot;{your-aws-region}}&quot;, &quot;profile&quot;: &quot;{your-profile-name}&quot; },&quot;proxy&quot;: &quot;http://username:password@proxyserver:port&quot; è¨­å®šå¾Œã€å¿…ãšZedã®å†èµ·å‹•ãŒå¿…è¦","link":"/2025/06/22/zed_bedrock/"},{"title":"zshã¨bashã¯é•ã†","text":"jqã‚’ä½¿ã£ãŸæ™‚ã«æ°—ã¥ã„ãŸè©± bashã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§.items[]ã‚’ãƒªãƒ†ãƒ©ãƒ«ãªæ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚ 123# bashecho '{&quot;items&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}' | jq -r .items[] | xargs echoa b c zshã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€ã‚¯ã‚©ãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å¼•æ•°ã‚’ã‚°ãƒ­ãƒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦æ‰±ãŠã†ã¨ã—ã¾ã™ã€‚ 123# zshecho '{&quot;items&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}' | jq -r .items[] | xargs echozsh: no matches found: .items[] zshã§ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ­£ã—ãå‹•ä½œã•ã›ã‚‹ã«ã¯ã€.items[]ã‚’ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ 12echo '{&quot;items&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]}' | jq -r '.items[]' | xargs echoa b c shellcheckã‚’ä½¿ã†ã¨å®‰å¿ƒMacã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã™ 1brew install shellcheck","link":"/2024/09/07/zsh_bash/"}],"tags":[{"name":"Route53","slug":"Route53","link":"/tags/Route53/"},{"name":"DNS","slug":"DNS","link":"/tags/DNS/"},{"name":"AWS Lambda","slug":"AWS-Lambda","link":"/tags/AWS-Lambda/"},{"name":"CI&#x2F;CD","slug":"CI-CD","link":"/tags/CI-CD/"},{"name":"Terraform","slug":"Terraform","link":"/tags/Terraform/"},{"name":"SAM","slug":"SAM","link":"/tags/SAM/"},{"name":"GitHub Actions","slug":"GitHub-Actions","link":"/tags/GitHub-Actions/"},{"name":"ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","slug":"ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£","link":"/tags/%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3/"},{"name":"ã‚¤ãƒ³ãƒ•ãƒ©","slug":"ã‚¤ãƒ³ãƒ•ãƒ©","link":"/tags/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"sshd","slug":"sshd","link":"/tags/sshd/"},{"name":"Node.js","slug":"Node-js","link":"/tags/Node-js/"},{"name":"mise","slug":"mise","link":"/tags/mise/"},{"name":"Slack","slug":"Slack","link":"/tags/Slack/"},{"name":"uv","slug":"uv","link":"/tags/uv/"},{"name":"Zed","slug":"Zed","link":"/tags/Zed/"},{"name":"Bedrock","slug":"Bedrock","link":"/tags/Bedrock/"},{"name":"zsh","slug":"zsh","link":"/tags/zsh/"},{"name":"bash","slug":"bash","link":"/tags/bash/"}],"categories":[{"name":"DNS","slug":"DNS","link":"/categories/DNS/"},{"name":"AWS","slug":"AWS","link":"/categories/AWS/"},{"name":"Linux","slug":"Linux","link":"/categories/Linux/"},{"name":"DevOps","slug":"AWS/DevOps","link":"/categories/AWS/DevOps/"},{"name":"Node.js","slug":"Node-js","link":"/categories/Node-js/"},{"name":"Slack","slug":"Slack","link":"/categories/Slack/"},{"name":"Python","slug":"Python","link":"/categories/Python/"},{"name":"Zed","slug":"Zed","link":"/categories/Zed/"},{"name":"Mac","slug":"Mac","link":"/categories/Mac/"}],"pages":[]}